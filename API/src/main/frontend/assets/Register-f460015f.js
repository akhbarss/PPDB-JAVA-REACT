import{j as e,S as f,w as g,y as L,z as O,l as y,h as B,r as s,g as T,t as _,u as q,e as $,v as F,P as z,B as J,T as V,d as P,E as U,J as M,K as G}from"./index-0e888dc4.js";import{r as Q}from"./registration-60bae3c6.js";import{S as X}from"./SideAuthLayout-985ee370.js";import{R as Y}from"./ResponseError-a1f53bf5.js";import{S as h}from"./Stepper-2429015b.js";const Z=({handleStepChange:n,active:l,noWhatsapp:o,setNoWhatsapp:u,alamat:i,asalSekolah:c,namaLengkap:r,setAlamat:S,jenkel:x,setJenkel:k,setAsalSekolah:m,setNamaLengkap:j})=>e.jsx("form",{onSubmit:()=>n(l+1),children:e.jsxs(f,{mt:20,children:[e.jsx(g,{label:"Nomor Whatsapp",description:"Harap masukan Nomor Aktif WhatsApp anda",withAsterisk:!0,type:"number",required:!0,autoFocus:!0,value:o,onChange:t=>u(t.target.value)}),e.jsx(g,{label:"Nama Lengkap",description:"Harap masukan Nama Lengkap sesuai dengan akta kelahiran",withAsterisk:!0,required:!0,value:r,onChange:t=>j(t.target.value)}),e.jsx(L,{label:"Alamat",description:"Harap masukan alamat rumah anda",withAsterisk:!0,required:!0,value:i,onChange:t=>S(t.target.value)}),e.jsx(O,{data:["Laki-laki","Perempuan"],label:"Jenis Kelamin",description:"Harap masukan jenis kelamin anda",value:x,onChange:k}),e.jsx(g,{label:"Asal Sekolah",description:"Masukan asal sekolah",withAsterisk:!0,required:!0,value:c,onChange:t=>m(t.target.value)}),e.jsx(y,{position:"center",mt:"xl",children:e.jsx(B,{type:"submit",children:"Simpan dan lanjutkan"})})]})}),ee=({noWhatsapp:n,password:l,setPassword:o,onSubmit:u,registrationMutation:i})=>{const c=r=>{r.preventDefault(),u()};return e.jsx("form",{onSubmit:c,children:e.jsxs(f,{mt:20,children:[e.jsx(g,{label:"Password",withAsterisk:!0,required:!0,type:"password",autoFocus:!0,value:l,onChange:r=>o(r.target.value)}),e.jsx(y,{position:"center",mt:"xl",children:e.jsx(B,{loading:i.status==="pending",type:"submit",children:"Simpan dan lanjutkan"})})]})})},oe=()=>{const[n,l]=s.useState(null),[o,u]=s.useState(""),[i,c]=s.useState(""),[r,S]=s.useState(""),[x,k]=s.useState(""),[m,j]=s.useState(""),[t,N]=s.useState(""),R=T(),[d,v]=s.useState(0),[W,D]=s.useState(d),w=_({mutationFn:Q}),{md:b}=q(),{pathname:A}=$();s.useEffect(()=>{const a=A.substring(1).split("/");l(a[3].toUpperCase())},[A]);const E=a=>{a>3||a<0||(v(a),D(H=>Math.max(H,a)))},I=a=>{w.mutate(a,{onSuccess:p=>{localStorage.setItem("_TuVbwpW",p.data.access_token),localStorage.setItem("_RuvTpQv",p.data.refresh_token),G.openContextModal({modal:"modalSuccess",innerProps:{onAccept:()=>{R("/ppdb/main/home")},modalBody:"Selamat, anda telah berhasil memulai awal PPDB. silahkan klik lanjutkan"},closeOnClickOutside:!1,closeOnEscape:!1,withCloseButton:!1})},onError:p=>Y(p)})},K=()=>{I({username:o,password:m,role:"USER",studentData:{address:r,name:i,school_origin:t}})},C=a=>W>=a&&d!==a;return e.jsx(F,{title:`
        Daftar
        ${n==="SMK"?"SMK":""}
        ${n==="SMP"?"SMP":""}`,children:e.jsxs(z,{pt:`${b?0:"70px"}`,className:"flex  min-h-[100vh]",children:[e.jsx(J,{className:`flex-[2] p-[0_1rem_] flex flex-col justify-center items-center overflow-y-auto min-h-[100vh] 
          ${!b&&"bg-[url(/big-bg-auth.png)]"} bg-cover bg-no-repeat bg-right`,children:e.jsxs(f,{w:`${b?"30rem":"20rem"}`,py:100,children:[e.jsxs(V,{align:"center",children:[e.jsx(P,{component:"span",children:"Daftar"}),e.jsxs(P,{component:"span",children:[n==="SMK"&&" SMK",n==="SMP"&&" SMP"]})]}),e.jsxs(h,{active:d,onStepClick:v,radius:"xs",mt:20,className:" ",styles:{stepIcon:{borderWidth:U(4)}},breakpoint:"sm",children:[e.jsx(h.Step,{label:"Identitas Diri",allowStepSelect:C(0),icon:e.jsx(M,{size:30}),children:e.jsx(Z,{noWhatsapp:o,setNoWhatsapp:u,active:d,handleStepChange:E,alamat:r,asalSekolah:t,namaLengkap:i,setAlamat:S,jenkel:x,setJenkel:k,setAsalSekolah:N,setNamaLengkap:c})}),e.jsx(h.Step,{label:"Informasi Kredensial",allowStepSelect:C(1),icon:e.jsx(M,{size:30}),children:e.jsx(ee,{registrationMutation:w,noWhatsapp:o,password:m,setPassword:j,onSubmit:K})}),e.jsx(h.Completed,{children:e.jsx(e.Fragment,{children:"Completed, click back button to get to previous step"})})]})]})}),e.jsx(X,{page:n})]})})};export{oe as default};
