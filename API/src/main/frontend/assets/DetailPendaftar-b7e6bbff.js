import{k as U,m as R,j as a,P as y,G as j,D as E,c as n,ah as o,p as d,bQ as B,w as F,B as b,a0 as W,A as S,bR as Y,a as aa,aO as H,aj as ea,b as V,l as J,S as O,$ as I,L as A,bS as sa,f as M,N as ra,_ as D,r as N,Q as X,o as la,O as oa,bM as ia,bT as ta,a1 as f}from"./index-7cb0f30c.js";import{s as na}from"./statusValue-1ba5fc7f.js";import{c as $}from"./imageUtils-86f0f647.js";import{T as L}from"./Textarea-e2def8bf.js";import{T}from"./ThemeIcon-75a01779.js";import{I as Z}from"./Image-9a78668e.js";import{B as ca}from"./Badge-46a18456.js";import{c as da,i as ha,m as ma}from"./changePassword-39b3380f.js";import{P as Q}from"./PasswordInput-5b94bbeb.js";import{F as xa}from"./Flex-19fefdff.js";const ja=async t=>{const{userId:i}=t;return(await U.get(`/v1/admin/registration-batch/detail?studentId=${i}`)).data},ga=({studentQuery:t})=>{var s,x,u;const i=R(),{data:e}=t,l={input:{":readOnly":{opacity:1}},label:{userSelect:"none",fontWeight:"bold"}},h=async c=>{const g=c&&await $(c);F.open({children:a.jsx(a.Fragment,{children:a.jsxs(b,{component:W.Autosize,className:"overflow-auto",children:[a.jsx(b,{className:"z-50 fixed top-0 right-0 left-0",p:10,children:a.jsx(S,{ml:"auto",variant:"light",onClick:()=>{F.closeAll()},children:a.jsx(Y,{size:30})})}),(g==null?void 0:g.length)>0?g.map((w,r)=>{const m=URL.createObjectURL(w);return a.jsx(Z,{src:m,imageProps:{onLoad:()=>URL.revokeObjectURL(m)}},r)}):a.jsx(b,{mt:20,p:100,sx:{justifyContent:"center",alignItems:"center"},children:a.jsx(n,{align:"center",fw:"bolder",fz:24,children:"Data kosong"})})]})}),size:"100rem",styles:{body:{padding:0},header:{display:"none"}},centered:!0})};return a.jsxs(a.Fragment,{children:[a.jsxs(y,{mt:40,withBorder:!0,shadow:"lg",p:"lg",sx:c=>({backgroundColor:i?c.colors.dark[9]:"white"}),children:[a.jsxs(j,{children:[a.jsx(E,{orientation:"vertical",size:"0.5rem",color:"#2A166F"}),a.jsx(n,{weight:"bold",size:30,children:"Identitas Diri"})]}),a.jsxs(o,{gutter:"lg",mt:20,children:[a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"NISN",value:e!=null&&e.data.nisn?e==null?void 0:e.data.nisn:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nomor Whatsapp",value:e!=null&&e.data.phone?e==null?void 0:e.data.phone:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Lengkap",value:e!=null&&e.data.name?e==null?void 0:e.data.name:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Panggilan",value:e!=null&&e.data.surname?e==null?void 0:e.data.surname:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Gender",value:e!=null&&e.data.gender?e==null?void 0:e.data.gender:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Agama",value:e!=null&&e.data.religion?e==null?void 0:e.data.religion:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Tempat Lahir",value:(s=e==null?void 0:e.data)!=null&&s.birth_place?(x=e==null?void 0:e.data)==null?void 0:x.birth_place:"",styles:l})}),a.jsx(o.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Tanggal Lahir",value:e!=null&&e.data.phone?new Date((u=e==null?void 0:e.data)==null?void 0:u.birth_date).toLocaleDateString():"",styles:l})}),a.jsx(o.Col,{span:12,children:a.jsx(L,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat",value:e!=null&&e.data.address?e==null?void 0:e.data.address:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Provinsi",value:e!=null&&e.data.province?e==null?void 0:e.data.province:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kabupaten/Kota",value:e!=null&&e.data.city?e==null?void 0:e.data.city:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kecamatan",value:e!=null&&e.data.sub_district?e==null?void 0:e.data.sub_district:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kelurahan",value:e!=null&&e.data.district?e==null?void 0:e.data.district:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kodepos",value:e!=null&&e.data.postal_code?e==null?void 0:e.data.postal_code:"",styles:l})}),a.jsx(o.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Asal Sekolah",value:e!=null&&e.data.school_origin?e==null?void 0:e.data.school_origin:"",styles:l})})]})]}),a.jsxs(y,{mt:40,withBorder:!0,shadow:"lg",p:"lg",sx:c=>({backgroundColor:i?c.colors.dark[9]:"white"}),children:[a.jsxs(j,{children:[a.jsx(E,{orientation:"vertical",size:"0.5rem",color:"#2A166F"}),a.jsx(n,{weight:"bold",size:30,children:"Informasi Orang Tua"})]}),a.jsxs(o,{gutter:"lg",mt:20,children:[a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Ayah",value:e!=null&&e.data.dad_name?e==null?void 0:e.data.dad_name:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Ibu",value:e!=null&&e.data.mother_name?e==null?void 0:e.data.mother_name:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Pekerjaan Ayah",value:e!=null&&e.data.dad_job?e==null?void 0:e.data.dad_job:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Pekerjaan Ibu",value:e!=null&&e.data.mother_job?e==null?void 0:e.data.mother_job:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"No Telp Ayah",value:e!=null&&e.data.dad_phone?e==null?void 0:e.data.dad_phone:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"No Telp Ibu",value:e!=null&&e.data.mother_phone?e==null?void 0:e.data.mother_phone:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(L,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat Ayah",value:e!=null&&e.data.dad_address?e==null?void 0:e.data.dad_address:"",styles:l})}),a.jsx(o.Col,{sm:6,children:a.jsx(L,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat Ibu",value:e!=null&&e.data.mother_address?e==null?void 0:e.data.mother_address:"",styles:l})}),a.jsxs(o.Col,{span:12,children:[a.jsx(n,{weight:"bold",size:18,children:"Lampiran Kartu Keluarga"}),a.jsxs(j,{py:"xs",px:"lg",bg:i?"black":"#E3E5FC",className:"rounded-md cursor-pointer",onClick:()=>{var c;h((c=e==null?void 0:e.data)==null?void 0:c.family_card)},children:[a.jsx(T,{radius:"100%",color:"#2A166F",size:45,children:a.jsx(B,{size:25})}),a.jsx(n,{size:20,weight:"bold",children:"File Kartu Keluarga"})]})]}),a.jsxs(o.Col,{span:12,children:[a.jsx(n,{weight:"bold",size:18,children:"Lampiran Akta"}),a.jsxs(j,{py:"xs",px:"lg",bg:i?"black":"#E3E5FC",className:"rounded-md cursor-pointer",onClick:()=>{var c;return h((c=e==null?void 0:e.data)==null?void 0:c.birth_card)},children:[a.jsx(T,{radius:"100%",color:"#2A166F",size:45,children:a.jsx(B,{size:25})}),a.jsx(n,{size:20,weight:"bold",children:"File Akta"})]})]})]})]})]})},ba=async t=>(await U.put("/v1/student/confirm-payment",t)).data,ua=async t=>{const{batchId:i,userId:e}=t;return(await U.get(`/v1/student/get-payments?batchId=${i}&studentId=${e}`)).data},pa=()=>{var w;const t=R(),i=aa(),{userId:e,gelombangId:l}=H(),h=ea(),{data:s,isFetching:x}=V({queryKey:["get_all_payment"],queryFn:()=>ua({batchId:l,userId:e})}),u=J({mutationFn:ba}),c=r=>{u.mutate(r,{onSuccess:m=>{console.log("Succes : ",m),h.invalidateQueries({queryKey:["get_all_payment"]}),h.invalidateQueries({queryKey:["get_student"]})},onError:m=>{console.log("Failed : ",m)}})},g=async r=>{const m=r&&await $(r);F.open({children:a.jsx(a.Fragment,{children:a.jsxs(b,{component:W.Autosize,className:"overflow-auto",children:[a.jsx(b,{className:"z-50 fixed top-0 right-0 left-0",p:10,children:a.jsx(S,{ml:"auto",variant:"light",onClick:()=>{F.closeAll()},children:a.jsx(Y,{size:30})})}),(m==null?void 0:m.length)>0?m.map((p,z)=>{const k=URL.createObjectURL(p);return a.jsx(Z,{src:k,imageProps:{onLoad:()=>URL.revokeObjectURL(k)}},z)}):a.jsx(b,{mt:20,p:100,sx:{justifyContent:"center",alignItems:"center"},children:a.jsx(n,{align:"center",fw:"bolder",fz:24,children:"Data kosong"})})]})}),size:"100rem",styles:{body:{padding:0},header:{display:"none"}},centered:!0})};return a.jsx(O,{children:x?a.jsx(a.Fragment,{children:a.jsx(I,{height:130})}):a.jsx(a.Fragment,{children:(s==null?void 0:s.data.length)>0?(w=s==null?void 0:s.data)==null?void 0:w.map(r=>{const m=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}),p=r==null?void 0:r.image,z=r.method==="TRANSFER",k=r.method==="CASH",v=(r==null?void 0:r.status)==="PAYMENT_CONFIRMED",P=(r==null?void 0:r.status)==="WAITING_PAYMENT";return a.jsx(y,{shadow:"lg",w:"100%",withBorder:!0,p:"lg",sx:C=>({backgroundColor:t?C.colors.dark[8]:C.white,flex:1}),children:a.jsxs(O,{children:[a.jsxs(j,{grow:!0,children:[a.jsxs(j,{children:[a.jsxs(ca,{size:"md",color:v&&"green"||P&&"red",styles:{root:{backgroundColor:`${v&&!t&&"#dcfce2"||(P?t?"#3D1B1C":"#ffd1d1":"")}`}},children:[(r==null?void 0:r.status)=="PAYMENT_CONFIRMED"&&a.jsx("p",{children:"Terkonfirmasi"}),(r==null?void 0:r.status)=="WAITING_PAYMENT"&&a.jsx("p",{children:"Belum Terkonfirmasi"})]}),z&&a.jsxs(n,{weight:"bold",children:[r.bank_name," - ",r.bank_account," a/n ",r.bank_user]}),k&&a.jsx(n,{weight:"bold",children:"Tunai"})]}),a.jsx(b,{children:a.jsxs(n,{weight:"bold",align:"right",c:t?"green":"#2A166F",children:["+ ",m.format(r==null?void 0:r.total).replace(",00","")]})})]}),a.jsxs(j,{p:"lg",bg:t?i.colors.dark[5]:"#E3E5FC",children:[a.jsxs(j,{className:"rounded-md cursor-pointer flex-[2]",onClick:()=>{g(p)},children:[a.jsx(T,{radius:"100%",color:"#2A166F",size:50,children:a.jsx(B,{size:30})}),a.jsx(n,{size:20,weight:"bold",children:"File Bukti Pembayaran"})]}),a.jsx(S,{component:A,to:`http://localhost:8080/uploads/${p}`,variant:"filled",color:"#2A166F",size:50,radius:"50%",target:"_blank",children:a.jsx(sa,{size:30})})]}),a.jsx(E,{}),a.jsxs(j,{grow:!0,children:[a.jsx(n,{children:"Sabtu, 04 November 2023"}),a.jsxs(j,{position:"right",children:[r.status==="PAYMENT_CONFIRMED"&&a.jsx(M,{color:"red",children:"Batalkan Konfirmasi"}),r.status==="WAITING_PAYMENT"&&a.jsx(M,{onClick:()=>{c({payment_id:r.id,student_id:+e})},children:"Konfirmasi"})]})]})]})},r.id)}):a.jsx(a.Fragment,{children:a.jsx(y,{shadow:"lg",p:"lg",withBorder:!0,children:a.jsx(n,{size:24,weight:"bold",children:"Belum ada Pembayaran"})})})})})},fa=()=>{const t=J({mutationFn:da}),i=ra({initialValues:{password:"",confirmPassword:""},validate:{password:ha("Harap isi password password baru"),confirmPassword:ma("password","Password tidak sama")}}),e=h=>{t.mutate(h,{onSuccess:s=>{D.success("Ubah password berhasil!"),i.reset()},onError:s=>{D.error("Gagal mengubah password")}})},l=h=>{e({password:h.password,id:"null"})};return a.jsx("form",{onSubmit:i.onSubmit(l),children:a.jsxs(O,{mt:30,children:[a.jsx(n,{mt:20,fz:30,fw:600,children:"Ubah Password"}),a.jsx(Q,{label:"Password Baru",...i.getInputProps("password")}),a.jsx(Q,{label:"Konfirmasi Password",...i.getInputProps("confirmPassword")}),a.jsx(j,{position:"right",mt:20,children:a.jsx(M,{type:"submit",loading:t.status==="pending",children:"Ubah Password"})})]})})},wa=({img:t})=>{const[i,e]=N.useState(null),[l,h]=N.useState(!1),s=N.useCallback(async()=>{h(!0);try{const x=await $(t);h(!1),e(x)}catch{h(!1),D.error("Gagal mmengambil foto profil")}},[t]);return N.useEffect(()=>{t&&s()},[t,s]),a.jsx(a.Fragment,{children:l?a.jsx(I,{circle:!0,height:200}):(i==null?void 0:i.length)>0&&i.map((x,u)=>{const c=URL.createObjectURL(x);return a.jsx(X,{src:c,imageProps:{onLoad:()=>URL.revokeObjectURL(c)},size:220,color:"cyan",sx:{border:"3px solid grey"},radius:"100%"},u)})})},Fa=()=>{var v,P,C,K,q,G;const{userId:t,gelombangId:i,tipeGelombang:e}=H(),l=R(),h=V({queryKey:["get_student"],queryFn:()=>ja({userId:t})}),{data:s,isError:x,error:u,isFetching:c}=h,g=u;if(x)return a.jsxs(y,{p:"lg",children:[a.jsx("h1",{children:((v=g==null?void 0:g.response)==null?void 0:v.status)===400?"Pendaftar tidak ditemukan":"Terjadi kesalahan"}),a.jsx(A,{className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit px-8 py-2 bg-black text-white rounded-full",to:`/ppdb/main/pendaftar-ppdb/${e}/${i}`,children:"Kembali"})]});const w=(P=s==null?void 0:s.data)==null?void 0:P.profile_picture,r=s==null?void 0:s.data.name,m=r==null?void 0:r.split(" ").map(_=>_.charAt(0).toUpperCase()).slice(0,2).join(""),p=na[(C=s==null?void 0:s.data)==null?void 0:C.status],z=new Date((K=s==null?void 0:s.data)==null?void 0:K.registrationDate),k=isNaN(z)?"Tanggal tidak valid":z.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return a.jsx(la,{title:"Detail Informasi Pendaftar",children:a.jsxs(O,{className:"max-w-[60rem] mx-auto",children:[a.jsx(oa,{label:"Detail Informasi Pendaftar"}),!c&&a.jsxs(A,{to:`/ppdb/main/pendaftar-ppdb/${e}/${i}`,className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit ",children:[a.jsx(ia,{color:`${l?"#9b87de":"#2A166F"}`}),a.jsx(n,{color:`${l?"#9b87de":"#2A166F"}`,children:"Kembali"})]}),a.jsxs(xa,{mt:40,p:"lg",direction:{base:"column",sm:"row"},gap:{base:"2rem",sm:"5rem"},align:"center",children:[c?a.jsx(I,{circle:!0,height:200}):w?a.jsx(a.Fragment,{children:a.jsx(wa,{img:w})}):a.jsx(X,{size:220,color:"cyan",sx:{border:"3px solid grey"},radius:"100%",children:m}),a.jsxs(b,{sx:{flex:1},className:"flex flex-col gap-4",children:[a.jsx(y,{w:"100%",withBorder:!0,p:"lg",shadow:"lg",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:a.jsxs(I,{visible:c,children:[a.jsx(n,{className:"select-all",c:"white",size:24,weight:"bolder",children:s==null?void 0:s.data.name}),a.jsxs(b,{w:"fit-content",mt:10,target:"_blank",component:A,to:`https://wa.me/${(q=s==null?void 0:s.data)==null?void 0:q.phone}?text=Halo%20nak`,className:"flex items-center no-underline gap-[10px]",children:[a.jsx(T,{size:30,radius:"lg",color:"green",children:a.jsx(ta,{})}),a.jsx(n,{size:"xl",c:"teal",weight:"bold",children:(G=s==null?void 0:s.data)==null?void 0:G.phone})]}),a.jsx(n,{mt:10,className:"select-all",c:"white",weight:"bold",children:s==null?void 0:s.data.address})]})}),a.jsx(y,{withBorder:!0,p:"lg",shadow:"lg",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:a.jsxs(I,{visible:c,children:[a.jsx(n,{sx:_=>({color:_.colors.gray[3]}),weight:"bold",children:"Status"}),a.jsx(n,{color:"white",weight:"bold",size:"xl",children:p==null?void 0:p.value}),a.jsx(n,{sx:_=>({color:_.colors.gray[3]}),mt:25,weight:"bold",children:"Tanggal Mendaftar"}),a.jsx(n,{size:"xl",color:"white",weight:"bold",children:k})]})})]},s==null?void 0:s.data.id)]}),a.jsxs(f,{defaultValue:"pembayaran",styles:{tabLabel:{fontSize:"20px"}},children:[a.jsxs(f.List,{children:[a.jsx(f.Tab,{value:"pembayaran",children:"Pembayaran"}),a.jsx(f.Tab,{value:"biodata",children:"Biodata"}),a.jsx(f.Tab,{value:"ubah_password",children:"Ubah Password"})]}),a.jsx(f.Panel,{value:"pembayaran",mt:30,children:a.jsx(pa,{})}),a.jsx(f.Panel,{value:"biodata",mt:30,children:a.jsx(ga,{studentQuery:h})}),a.jsx(f.Panel,{value:"ubah_password",mt:30,children:a.jsx(fa,{})})]})]})},s==null?void 0:s.data.id)};export{Fa as default};
