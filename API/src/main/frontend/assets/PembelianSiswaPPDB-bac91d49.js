import{e as d,b as h,q as j,l as m,j as a,m as y,a5 as P,S as k,a6 as b,D as F,a7 as w,a8 as v,a9 as C,aa as E}from"./index-21f1c136.js";import{u as L,g as T,T as _,S as B,F as D,a as I,b as M,c as N,d as R}from"./StepPilihJurusan-7d4b7b97.js";import"./ResponseError-040dbf2a.js";import"./FormWrapper-e88946a9.js";const A=o=>a.jsx(w,{unstyled:!0,styles:e=>({tab:{...e.fn.focusStyles(),backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.white,color:e.colorScheme==="dark"?"white":e.colors.gray[9],border:"none",boxShadow:"0 10px 20px -10px rgba(0,0,0,0.2)",cursor:"pointer",fontSize:e.fontSizes.sm,borderRadius:"5px","&:disabled":{cursor:"not-allowed",color:e.colorScheme==="dark"?e.colors.gray[4]:e.colors.gray[8],backgroundColor:e.colorScheme==="dark"?e.colors.dark[6]:e.colors.gray[4]},"&[data-active]":{background:"linear-gradient(45deg, #4c6ef5 0%, #15aabf 100%)",borderColor:e.colors.blue[7],color:e.white,boxShadow:"0 10px 20px -10px rgba(0,0,0,0.5)"}},tabsList:{overflowX:"auto"}}),...o}),u=[{index:1,label:"Pilih Gelombang PPDB",icon:v,content:a.jsx(B,{type:"PEMBELIAN"})},{index:2,label:"Transaksi Pembelian",icon:D,content:a.jsx(I,{})},{index:3,label:"Pilih Jurusan",icon:C,content:a.jsx(M,{})},{index:4,label:"Cetak Kartu Peserta",icon:E,content:a.jsx(N,{})}],J=()=>{var g;const[o,e]=d.useState({step:1,stagingId:null}),{data:n,isLoading:G,isSuccess:c,isFetching:x}=h({queryKey:["get_last_offset_batch"],queryFn:()=>R("PEMBELIAN"),staleTime:0,notifyOnChangeProps:"all"}),i=L(o),p=j(),f=m();d.useEffect(()=>{e(i==null?void 0:i.initialValues)},[i]),d.useEffect(()=>{if(c){const s=n.data.filter(t=>t.is_done===1);if(s.length>0)if(n.data[n.data.length-1].index!==s[s.length-1].index){const t=s[s.length-1].index+1;l(t.toString())}else l(s[s.length-1].index.toString());else l("1")}},[n,c]);const l=s=>{var r;const t={step:+s,stagingId:(r=n.data.find(S=>S.index===+s))==null?void 0:r.id};e(t),f(`${p.pathname}?${T(t)}`)};return a.jsxs(y,{title:"Pembelian",children:[a.jsx(P,{label:"Pembelian"}),a.jsx(k,{className:"style-box ",children:a.jsxs(A,{value:`${o.step}`,onTabChange:l,children:[a.jsx(a.Fragment,{children:x?a.jsx(b,{mt:40,width:"100%",height:200,visible:!0}):a.jsx(a.Fragment,{children:c&&a.jsx(_,{activeTabIndex:+o.step,card:n.data.map((s,t)=>{var r;return{label:s.name,index:s.index,icon:(r=u[t])==null?void 0:r.icon,is_done:s.is_done===1}})})})}),a.jsx(F,{my:20}),x?a.jsx(b,{mt:40,width:"100%",height:200,visible:!0}):a.jsx(a.Fragment,{children:(g=u.find(s=>s.index===o.step))==null?void 0:g.content})]})})]})};export{J as default};
