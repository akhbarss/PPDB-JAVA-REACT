import{k as w,d as O,e as V,m as K,aO as T,r as U,b as j,l as H,j as a,L as F,A as J,o as W,O as Q,S as X,bM as Y,c as o,P as M,B as g,$ as u,T as Z,G as ee,f as ae,_ as P}from"./index-c1683f52.js";import{D as te,c as se}from"./DataTable-8d86c960.js";import{s as ne}from"./statusValue-1ba5fc7f.js";import{B as re}from"./Badge-e28c5e5c.js";import{c as oe}from"./createReactComponent-7e6ec58e.js";import"./Flex-5072689f.js";import"./Select-596909b4.js";import"./Card-2740124a.js";var le=oe("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const ce=async t=>(await w.get("/v1/admin/registration-batch/get?id="+t)).data,de=async t=>{O.get(V+"/public/get-student-to-excel?batchId="+t,{responseType:"blob"}).then(s=>{s.headers["Content-Disposition"];const p=window.URL.createObjectURL(new Blob([s.data])),c=document.createElement("a");c.href=p,c.setAttribute("download","student_data.xls"),document.body.appendChild(c),c.click()}).catch(s=>{console.error("Gagal mengunduh file Excel:",s)})},ie=async t=>(await w.get(`/v1/admin/registration-batch/get-students?batchId=${t}&page=0&size=1000`)).data,he=async t=>(await w.get("/v1/admin/registration-batch/count-data?batchId="+t)).data,ye=()=>{var S,k,D,I,_,v,B,E;const t=K(),{gelombangId:s}=T(),[p,c]=U.useState(""),{tipeGelombang:y}=T(),{data:d,isLoading:x}=j({queryKey:["get_total_pendaftar_batch"],queryFn:()=>he(s)}),A=H({mutationFn:de}),L=e=>{A.mutate(e,{onSuccess:n=>{P.success("Success")},onError:n=>P.error("Gagal")})},{data:r,isFetching:f,isError:$,error:C}=j({queryKey:["get_all_student_by_batch_id"],queryFn:()=>ie(s)}),{data:i,isLoading:G}=j({queryKey:["get_gelombang_by_id"],queryFn:()=>ce(s)}),N=(S=r==null?void 0:r.data)==null?void 0:S.totalElements,q=(k=r==null?void 0:r.data)==null?void 0:k.totalPages,b=(I=(D=r==null?void 0:r.data)==null?void 0:D.content)==null?void 0:I.map(e=>({id:(e==null?void 0:e.id)??1,nama:(e==null?void 0:e.name)??"-",noWa:(e==null?void 0:e.phone)??"-",status:(e==null?void 0:e.status)??null,tanggalMendaftar:(e==null?void 0:e.registration_Date)??null})),m=b==null?void 0:b.filter(e=>e),z=m==null?void 0:m.filter(e=>e.nama.toLowerCase().includes(p.toLowerCase())),l=se(),R=[l.accessor(e=>e.id,{id:"Id",cell:e=>e.row.index+1,header:()=>a.jsx("span",{children:"ID"})}),l.accessor(e=>e.nama,{id:"Nama",cell:e=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:e.getValue()}),header:()=>a.jsx("span",{children:"Nama"})}),l.accessor(e=>e.noWa,{id:"No Telepon",cell:e=>e.getValue(),header:()=>a.jsx("span",{children:"No. Telepon"})}),l.accessor(e=>e.tanggalMendaftar,{id:"Tanggal Mendaftar",cell:e=>{const n=e.getValue(),h=n&&new Date(n);return n?h.toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"},header:()=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:"Tanggal Mendaftar"})}),l.accessor(e=>e.status,{id:"Status",cell:e=>{const n=e.getValue(),h=ne[n];return h?a.jsx(re,{size:"lg",color:h.color,bg:!t&&"#dcfce2",children:h.value}):"-"},header:()=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:"Status"})}),l.display({id:"Detail",cell:e=>{const n=e.row.original.id;return a.jsx(F,{to:`/ppdb/main/pendaftar-ppdb/${y}/${s}/${n}`,className:"bg-blue-600 px-4 py-[3px] no-underline text-white rounded-full font-bold",children:"Detail"})},header:()=>a.jsx("span",{children:"Detail"})}),l.display({id:"Aksi",cell:e=>{const n=e.row.original.id;return a.jsx(J,{color:"red",variant:"filled",onClick:()=>console.log(n),children:a.jsx(le,{})})},header:()=>a.jsx("span",{children:"Aksi"})})];return a.jsxs(W,{title:"Seleksi Gelombang",children:[a.jsx(Q,{label:"Seleksi Gelombang"}),a.jsxs(X,{mt:20,children:[!f&&a.jsxs(F,{to:`/ppdb/main/pendaftar-ppdb/${y}`,className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit cursor-pointer",children:[a.jsx(Y,{color:`${t?"#9b87de":"#2A166F"}`}),a.jsx(o,{color:`${t?"#9b87de":"#2A166F"}`,children:"Kembali"})]}),a.jsxs(M,{withBorder:!0,p:"md",radius:"md",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:[a.jsx(g,{children:G?a.jsx(u,{height:35,w:400}):a.jsx(Z,{c:"white",order:2,children:(_=i==null?void 0:i.data)==null?void 0:_.name})}),a.jsxs(g,{bg:`${t?"#1A1B1E":"#FFFFFF"}`,sx:{padding:"0.5rem 1.5rem",marginTop:"1rem",display:"flex",gap:"2rem",borderRadius:"10px"},children:[a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Jumlah Pendaftar"}),x?a.jsx(u,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(v=d==null?void 0:d.data)==null?void 0:v.totalStudents," Orang"]})]}),a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Jumlah Penerimaan"}),x?a.jsx(u,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(B=i==null?void 0:i.data)==null?void 0:B.max_quota," Orang"]})]}),a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Peserta Diterima"}),x?a.jsx(u,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(E=d==null?void 0:d.data)==null?void 0:E.studentAccepted," Orang"]})]})]})]}),a.jsxs(M,{withBorder:!0,p:"md",radius:"md",children:[a.jsxs(ee,{mb:20,children:[a.jsx(o,{sx:{flex:1},size:"lg",weight:500,mb:10,children:"Data Pendaftar"}),a.jsx(ae,{onClick:()=>L(s),children:"Export Excel"})]}),$?a.jsx(o,{children:C.message}):a.jsx(te,{data:z,canExpand:()=>!0,columns:R,loading:f,useSearchInput:!0,noCard:!0,usePagination:!1,onSearch:e=>c(e.toLowerCase()),totalRecords:N,pagination:{pageIndex:0,pageSize:1e3},pageCount:q})]})]})]})};export{ye as default};
