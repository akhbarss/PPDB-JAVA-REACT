import{k as G,j as e,aL as se,S as ne,p as _,ah as q,bE as K,G as P,f as T,aA as z,N as re,b as oe,l as R,P as Z,bF as ke,B as le,c as D,L as be,bG as L,A as ee,bH as xe,aI as de,T as ue,_ as h,aD as je,m as ge,aO as De,a as we,o as fe,$ as Te,aM as Ce,aN as ye}from"./index-e253d264.js";import{b as Ie}from"./index.esm-df819014.js";import{A as W,e as Pe,C as Se}from"./index.esm-d794707d.js";import{T as ae}from"./ThemeIcon-4090ae4b.js";import{B as ce}from"./Badge-379626d7.js";import{S as _e}from"./Select-d0d7a6fd.js";const Ge=async t=>{const{idJalur:s,payloadCreate:r}=t,k={...r,path_id:s};return(await G.post("/v1/admin/registration-batch/post",k)).data},Ue=async t=>(await G.delete("/v1/admin/registration-batch/delete?id="+t.id)).data,ve=async t=>{const{id:s,bank_account:r,bank_name:k,bank_user:j,end_date:w,index:o,max_quota:C,name:l,price:U,start_date:u,batchCode:x}=t,c={bank_account:r,bank_name:k,bank_user:j,start_date:u,end_date:w,index:o,max_quota:C,name:l,price:U,batchCode:x};return(await G.patch("/v1/admin/registration-batch/update?id="+s,c)).data},Be=async t=>(await G.get("/v1/admin/registration-batch/get-batch-by-pathsId?pathsId="+t)).data,Fe=async t=>(await G.post("/v1/user/exam-information/create",t)).data,Ee=async t=>{const{id:s}=t;return(await G.delete("/v1/user/exam-information/delete?id="+s)).data},qe=async t=>{const{id:s,...r}=t;return(await G.patch("/v1/user/exam-information/update?id="+s,r)).data},ze=async t=>(await G.get("/v1/user/exam-information/index?batchId="+t)).data,te=({action:{actionFn:t,label:s},formMantine:r,close:k,loading:j,opened:w,title:o})=>{const C=l=>{t(l)};return e.jsx(se,{onClose:k,opened:w,size:"40rem",title:o,withFooter:!1,children:e.jsxs("form",{onSubmit:r.onSubmit(l=>C(l)),children:[e.jsxs(ne,{p:20,pb:"6rem",children:[e.jsx(_,{required:!0,label:"Nama Test Ujian",...r.getInputProps("nama")}),e.jsx(_,{required:!0,label:"Link Test Ujian",...r.getInputProps("link")}),e.jsxs(q,{children:[e.jsx(q.Col,{md:6,children:e.jsx(K,{withAsterisk:!0,"aria-required":"true",label:"Waktu Pendaftaran Dibuka",dropdownType:"modal",...r.getInputProps("waktuDibuka"),clearable:!0})}),e.jsx(q.Col,{md:6,children:e.jsx(K,{required:!0,label:"Waktu Pendaftaran Ditutup",dropdownType:"modal",...r.getInputProps("waktuDitutup"),clearable:!0})})]})]}),e.jsxs(P,{position:"right",sx:l=>({position:"absolute",bottom:0,right:0,left:0,padding:"1rem 4rem",backgroundColor:l.colorScheme==="dark"?"black":"whitesmoke",zIndex:1}),children:[e.jsx(T,{variant:"outline",onClick:()=>k(),disabled:j,children:"Batal"}),e.jsx(T,{type:"submit",loading:j,children:s})]})]})})},Re=({idGelombang:t})=>{const[s,{open:r,close:k}]=z(!1),[j,{open:w,close:o}]=z(!1),[C,{open:l,close:U}]=z(!1),u=re({initialValues:{id:null,link:"",nama:"",waktuDibuka:null,waktuDitutup:null},transformValues:a=>({...a,waktuDibuka:a.waktuDibuka.toISOString(),waktuDitutup:a.waktuDitutup.toISOString()}),validate:{waktuDibuka:a=>a===null?"Tolong masukkan waktu dibuka":null,waktuDitutup:a=>a===null?"Tolong masukkan waktu ditutup":null}}),{data:x,refetch:c}=oe({queryKey:["get_test_ujian"+t],queryFn:()=>ze(t)}),b=R({mutationFn:Fe}),A=R({mutationFn:Ee}),v=R({mutationFn:qe});function M(a){b.mutate(a,{onSuccess:()=>{c(),h.success("Data berhasil ditambahkan"),k(),u.reset()},onError:()=>{h.error("Data gagal ditambahkan")}})}function V(a){const{link:y,nama:g,waktuDibuka:f,waktuDitutup:B}=a;M({link:y,title:g,batchId:t,endDate:B,startDate:f})}function N(a){v.mutate(a,{onSuccess:()=>{c(),o(),h.success("Data berhasil diubah"),u.reset()},onError:()=>{h.error("Data gagal diubah")}})}function Q(a){const{link:y,nama:g,waktuDibuka:f,waktuDitutup:B,id:F}=a;N({id:F,link:y,title:g,endDate:B,startDate:f})}function X(a){A.mutate(a,{onSuccess:()=>{c(),h.success("Data berhasil dihapus"),U(),u.reset()},onError:()=>{h.error("Gagal menghapus data")}})}return e.jsxs(e.Fragment,{children:[(x==null?void 0:x.data)&&(x==null?void 0:x.data.sort((a,y)=>a.id-y.id).map((a,y)=>{const g=a!=null&&a.startDate?new Date(a==null?void 0:a.startDate):null,f=a!=null&&a.endDate?new Date(a==null?void 0:a.endDate):null,F=new Date>=g&&g<=f,J=g?g.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",$=f?f.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date";return e.jsx(Z,{withBorder:!0,p:"1rem",sx:n=>({backgroundColor:n.colorScheme==="dark"?n.colors.dark[9]:n.colors["brand-smp"][0],display:"flex",justifyContent:"space-between",alignItems:"center"}),children:e.jsxs(P,{align:"start",w:"100%",children:[e.jsxs(P,{sx:{flex:2},children:[e.jsx(ae,{radius:"100%",size:50,mx:"sm",children:e.jsx(ke,{size:30})}),e.jsxs(le,{sx:{flex:2},children:[e.jsx(D,{size:16,weight:"bolder",children:a.title}),e.jsxs(D,{children:[J," – ",$]}),e.jsxs(D,{children:["Link Tes Online : ",e.jsx(D,{target:"_blank",c:"blue",component:be,to:a.link&&a.link,children:a.link&&a.link})]})]})]}),e.jsxs(P,{children:[e.jsx(ce,{variant:"light",color:`${F?"green":"red"}`,size:"lg",children:F?"Dibuka":"Ditutup"}),e.jsxs(L,{withArrow:!0,width:100,position:"left-start",onOpen:()=>{u.setValues({id:a.id,nama:a.title})},onClose:()=>{console.log("close")},children:[e.jsx(L.Target,{children:e.jsx(ee,{variant:"transparent",children:e.jsx(xe,{size:30})})}),e.jsxs(L.Dropdown,{children:[e.jsx(L.Item,{onClick:()=>{w(),u.setValues({id:a.id,nama:a.title,waktuDibuka:g,waktuDitutup:f,link:a.link})},children:"Edit"}),e.jsx(L.Item,{onClick:()=>{l()},children:"Delete"})]})]})]})]})},a!=null&&a.id?a.id:y)})),e.jsx(T,{onClick:()=>r(),children:"Tambah Ujian"}),e.jsx(te,{formMantine:u,action:{label:"Tambah",actionFn:V},close:()=>{k(),u.reset()},loading:b.status==="pending",opened:s,title:"Tambah Tes Ujian"}),e.jsx(te,{formMantine:u,action:{label:"Ubah",actionFn:Q},close:()=>{o(),u.reset()},loading:v.status==="pending",opened:j,title:"Ubah Tes Ujian"}),e.jsxs(de,{centered:!0,closeOnEscape:!1,closeOnClickOutside:!1,withCloseButton:!1,opened:C,onClose:()=>{U(),u.reset()},children:[e.jsx(ue,{order:3,children:"Hapus Tes Ujian"}),e.jsxs(D,{mt:20,children:["Anda yakin ingin menghapus tes ujian ",u.values.nama,"?"]}),e.jsxs(P,{mt:20,position:"right",children:[e.jsx(T,{disabled:A.status==="pending",variant:"outline",onClick:()=>{U(),u.reset()},children:"Batal"}),e.jsx(T,{variant:"danger",onClick:()=>X({id:u.values.id}),loading:A.status==="pending",children:"Hapus"})]})]})]})},ie=({title:t,close:s,opened:r,action:{actionFn:k,label:j},loading:w,formMantine:o})=>{function C(l){k(l)}return e.jsx(se,{onClose:s,opened:r,size:"40rem",title:t,withFooter:!1,children:e.jsxs("form",{onSubmit:o.onSubmit(l=>C(l)),children:[e.jsxs(ne,{p:20,pb:"6rem",children:[e.jsx(_,{required:!0,label:"Nama",...o.getInputProps("nama")}),e.jsx(_,{required:!0,label:"Jumlah Penerimaan",type:"number",...o.getInputProps("jumlahPenerimaan")}),e.jsxs(q,{children:[e.jsx(q.Col,{md:6,children:e.jsx(K,{withAsterisk:!0,"aria-required":"true",label:"Waktu Pendaftaran Dibuka",dropdownType:"modal",...o.getInputProps("waktuDibuka"),clearable:!0})}),e.jsx(q.Col,{md:6,children:e.jsx(K,{required:!0,label:"Waktu Pendaftaran Ditutup",dropdownType:"modal",...o.getInputProps("waktuDitutup"),clearable:!0})})]}),e.jsx(_e,{required:!0,label:"Nama Bank",defaultValue:"CIMB",...o.getInputProps("namaBank"),data:["CIMB","BCA","BRI","BNI","MANDIRI"]}),e.jsx(_,{required:!0,label:"Nomor Rekening",type:"number",...o.getInputProps("nomorRekening")}),e.jsx(_,{required:!0,label:"Nama Pemilik Rekening",...o.getInputProps("namaPemilikRekening")}),e.jsx(je,{required:!0,thousandSeparator:".",decimalSeparator:",",prefix:"Rp. ",customInput:_,placeholder:"Rp. 0",label:"Biaya Pendaftaran",description:"Input Nominal",...o.getInputProps("biayaPendaftaran"),withAsterisk:!0}),e.jsx(_,{label:"Kode Gelombang",required:!0,...o.getInputProps("kodeGelombang")})]}),e.jsxs(P,{position:"right",sx:l=>({position:"absolute",bottom:0,right:0,left:0,padding:"1rem 4rem",backgroundColor:l.colorScheme==="dark"?"black":"whitesmoke",zIndex:1}),children:[e.jsx(T,{variant:"outline",onClick:()=>s(),children:"Batal"}),e.jsx(T,{type:"submit",loading:w,children:j})]})]})})},Ve=()=>{var J,$;const t=ge(),{idJalurPendaftaran:s}=De(),r=we(),[k,{open:j,close:w}]=z(!1),[o,{open:C,close:l}]=z(!1),[U,{open:u,close:x}]=z(!1),c=re({initialValues:{id:null,nama:"",jumlahPenerimaan:"",waktuDibuka:null,waktuDitutup:null,namaBank:"",nomorRekening:"",namaPemilikRekening:"",biayaPendaftaran:null,kodeGelombang:""},transformValues:n=>({...n,biayaPendaftaran:+n.biayaPendaftaran.substring(4).replace(/\./g,""),waktuDibuka:n.waktuDibuka.toISOString(),waktuDitutup:n.waktuDitutup.toISOString()}),validate:{waktuDibuka:n=>n===null?"Tolong masukkan waktu dibuka":null,waktuDitutup:n=>n===null?"Tolong masukkan waktu ditutup":null}}),{data:b,isLoading:A,refetch:v}=oe({queryKey:["get_gelombang_by_id_jalur"],queryFn:()=>Be(s)}),M=R({mutationFn:Ge}),V=R({mutationFn:ve}),N=R({mutationFn:Ue});function Q(n){M.mutate(n,{onSuccess:()=>{v(),w(),c.reset(),h.success("Data berhasil ditambahkan")},onError:i=>{var d,p;const m=(p=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:p.messages;if(m){h.error(m);return}h.error("Data gagal ditambahkan")}})}function X(n){V.mutate(n,{onSuccess:()=>{l(),v(),c.reset(),h.success("Data berhasil diubah")},onError:i=>{var d,p;const m=(p=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:p.messages;if(m){h.error(m);return}h.error("Data gagal diubah")}})}function a(n){N.mutate(n,{onSuccess:()=>{x(),v(),h.success("Data berhasil dihapus")},onError:i=>{var d,p;const m=(p=(d=i==null?void 0:i.response)==null?void 0:d.data)==null?void 0:p.messages;if(m){h.error(m);return}h.error("Data gagal dihapus")}})}function y(n){const{biayaPendaftaran:i,jumlahPenerimaan:m,nama:d,namaBank:p,namaPemilikRekening:E,nomorRekening:S,waktuDibuka:I,waktuDitutup:O,kodeGelombang:H}=n;Q({idJalur:+s,payloadCreate:{bank_account:S,bank_name:p,bank_user:E,end_date:O,index:1,max_quota:+m,name:d,price:i,start_date:I,batchCode:H}})}function g(n){const{id:i,biayaPendaftaran:m,jumlahPenerimaan:d,nama:p,namaBank:E,namaPemilikRekening:S,nomorRekening:I,waktuDibuka:O,waktuDitutup:H,kodeGelombang:Y}=n;X({id:+i,bank_account:I,bank_name:E,bank_user:S,end_date:H,index:1,max_quota:+d,name:p,price:m,start_date:O,batchCode:Y})}function f(n){a({id:n})}function B({propss:n,data:i}){return e.jsxs(Se,{children:[e.jsx(W.Control,{...n,className:"font-bold"}),e.jsxs("div",{style:{paddingInline:"16px",display:"flex",gap:"8px"},children:[e.jsx(ee,{variant:"filled",color:"brand-smp",size:40,radius:100,onClick:()=>{const{bank_account:m,bank_name:d,bank_user:p,end_date:E,max_quota:S,name:I,price:O,start_date:H,id:Y,batchCode:me}=i,pe=new Date(H),he=new Date(E);c.setValues({id:Y,biayaPendaftaran:"Rp. "+O,jumlahPenerimaan:S+"",kodeGelombang:me,nama:I,namaBank:d,namaPemilikRekening:p,nomorRekening:m,waktuDibuka:pe,waktuDitutup:he}),C()},children:e.jsx(Ce,{size:20})}),e.jsx(ee,{variant:"filled",color:"brand-smp",size:40,radius:100,onClick:()=>{u(),c.setValues({id:i.id})},children:e.jsx(ye,{size:20})})]})]})}const F=e.jsx(e.Fragment,{children:b!=null&&b.data&&((J=b==null?void 0:b.data)==null?void 0:J.length)<1?"":e.jsx(W,{multiple:!0,variant:"separated",chevronPosition:"left",mt:30,children:($=b==null?void 0:b.data)==null?void 0:$.sort((n,i)=>n.id-i.id).map(n=>{const i=n!=null&&n.start_date?new Date(n.start_date):null,m=i?i.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",d=n!=null&&n.end_date?new Date(n.end_date):null,p=d?d.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",S=new Date>=i&&i<=d;return e.jsxs(W.Item,{value:n.id.toString(),sx:{boxShadow:"0 4px 10px -6px black",padding:"0 0.5rem",border:"0.0625rem solid #dee2e6",backgroundColor:`${t?r.colors.dark[9]:"white"}`,"&[data-active]":{backgroundColor:t?r.colors.dark[8]:"white",border:"0.0625rem solid #dee2e6"}},children:[e.jsx(B,{propss:{id:n.id.toString(),children:e.jsxs(e.Fragment,{children:[e.jsx(D,{fw:600,size:26,children:n.name}),e.jsxs(P,{mt:5,children:[e.jsx(ae,{variant:"light",size:30,radius:"50%",children:e.jsx(Ie,{size:15})}),e.jsxs(D,{size:16,children:[" ",n.countStudent," Pendaftar"]})]})]})},data:n}),e.jsx(W.Panel,{sx:{borderTop:`1px solid ${t?"gray":"#d9d9d9"}`},children:e.jsxs(ne,{p:"1rem",children:[e.jsxs(Z,{withBorder:!0,p:"1rem",sx:I=>({backgroundColor:I.colorScheme==="dark"?I.colors.dark[9]:I.colors["brand-smp"][0],display:"flex",justifyContent:"space-between",alignItems:"center"}),children:[e.jsxs(P,{children:[e.jsx(ae,{radius:"100%",size:50,mx:"sm",children:e.jsx(Pe,{size:30})}),e.jsxs(le,{children:[e.jsx(D,{size:16,weight:"bolder",children:"Pendaftaran Gelombang"}),e.jsxs(D,{children:[m," – ",p]})]})]}),e.jsx(ce,{variant:"light",color:`${S?"green":"red"}`,size:"lg",children:S?"Dibuka":"Ditutup"})]}),e.jsx(Re,{idGelombang:n.id})]})})]},n.id)})})});return e.jsxs(fe,{title:"Gelombang",children:[e.jsxs(Z,{withBorder:!0,shadow:"sm",radius:"4rem",px:"2.5rem",bg:t?r.colors.dark[8]:"white",sx:{display:"flex",justifyContent:"space-between",padding:"1rem 2rem"},children:[e.jsx(D,{weight:"bold",size:"xl",children:"Daftar Gelombang"}),e.jsx(T,{onClick:()=>j(),children:"Tambah"})]}),A?e.jsx(Te,{height:80}):F,e.jsx(ie,{title:"Tambah Gelombang PPDB",opened:k,close:w,formMantine:c,action:{actionFn:y,label:"Tambah"},loading:M.status==="pending"}),e.jsx(ie,{title:"Ubah Gelombang PPDB",opened:o,formMantine:c,action:{actionFn:g,label:"Ubah"},close:()=>{l(),c.reset()},loading:V.status==="pending"}),e.jsxs(de,{centered:!0,closeOnEscape:!1,closeOnClickOutside:!1,withCloseButton:!1,opened:U,onClose:()=>{x(),c.reset()},children:[e.jsx(ue,{order:3,children:"Hapus Gelombang"}),e.jsxs(D,{mt:20,children:["Anda yakin ingin menghapus gelombang ",c.values.nama,"?"]}),e.jsxs(P,{mt:20,position:"right",children:[e.jsx(T,{disabled:N.status==="pending",variant:"outline",onClick:()=>{x(),c.reset()},children:"Batal"}),e.jsx(T,{variant:"danger",onClick:()=>f(c.values.id),loading:N.status==="pending",children:"Hapus"})]})]})]})};export{Ve as default};
