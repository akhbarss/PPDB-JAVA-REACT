import{k as S,m as q,j as a,P as z,G as x,D as U,c,ah as i,p as d,bQ as K,w as F,B as b,a0 as Y,A as R,bR as H,a as aa,aO as G,aj as ea,aA as sa,b as V,l as J,S as E,$ as O,L as B,bS as ra,f as $,aI as la,_ as T,N as oa,r as L,Q as X,o as ia,O as na,bM as ta,bT as ca,a1 as p}from"./index-c1683f52.js";import{s as da}from"./statusValue-1ba5fc7f.js";import{c as Q}from"./imageUtils-040c21d1.js";import{T as D}from"./Textarea-141a74e1.js";import{T as M}from"./ThemeIcon-f86b9a1e.js";import{I as Z}from"./Image-8a2939c8.js";import{B as ha}from"./Badge-e28c5e5c.js";import{i as ma,m as xa}from"./matches-field-78072a21.js";import{P as W}from"./PasswordInput-25213393.js";import{F as ja}from"./Flex-5072689f.js";const ga=async n=>{const{userId:t}=n;return(await S.get(`/v1/admin/registration-batch/detail?studentId=${t}`)).data},ba=({studentQuery:n})=>{var s,m,u;const t=q(),{data:e}=n,l={input:{":readOnly":{opacity:1}},label:{userSelect:"none",fontWeight:"bold"}},h=async o=>{const j=o&&await Q(o);F.open({children:a.jsx(a.Fragment,{children:a.jsxs(b,{component:Y.Autosize,className:"overflow-auto",children:[a.jsx(b,{className:"z-50 fixed top-0 right-0 left-0",p:10,children:a.jsx(R,{ml:"auto",variant:"light",onClick:()=>{F.closeAll()},children:a.jsx(H,{size:30})})}),(j==null?void 0:j.length)>0?j.map((k,f)=>{const v=URL.createObjectURL(k);return a.jsx(Z,{src:v,imageProps:{onLoad:()=>URL.revokeObjectURL(v)}},f)}):a.jsx(b,{mt:20,p:100,sx:{justifyContent:"center",alignItems:"center"},children:a.jsx(c,{align:"center",fw:"bolder",fz:24,children:"Data kosong"})})]})}),size:"100rem",styles:{body:{padding:0},header:{display:"none"}},centered:!0})};return a.jsxs(a.Fragment,{children:[a.jsxs(z,{mt:40,withBorder:!0,shadow:"lg",p:"lg",sx:o=>({backgroundColor:t?o.colors.dark[9]:"white"}),children:[a.jsxs(x,{children:[a.jsx(U,{orientation:"vertical",size:"0.5rem",color:"#2A166F"}),a.jsx(c,{weight:"bold",size:30,children:"Identitas Diri"})]}),a.jsxs(i,{gutter:"lg",mt:20,children:[a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"NISN",value:e!=null&&e.data.nisn?e==null?void 0:e.data.nisn:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nomor Whatsapp",value:e!=null&&e.data.phone?e==null?void 0:e.data.phone:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Lengkap",value:e!=null&&e.data.name?e==null?void 0:e.data.name:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Panggilan",value:e!=null&&e.data.surname?e==null?void 0:e.data.surname:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Gender",value:e!=null&&e.data.gender?e==null?void 0:e.data.gender:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Agama",value:e!=null&&e.data.religion?e==null?void 0:e.data.religion:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Tempat Lahir",value:(s=e==null?void 0:e.data)!=null&&s.birth_place?(m=e==null?void 0:e.data)==null?void 0:m.birth_place:"",styles:l})}),a.jsx(i.Col,{md:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Tanggal Lahir",value:e!=null&&e.data.phone?new Date((u=e==null?void 0:e.data)==null?void 0:u.birth_date).toLocaleDateString():"",styles:l})}),a.jsx(i.Col,{span:12,children:a.jsx(D,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat",value:e!=null&&e.data.address?e==null?void 0:e.data.address:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Provinsi",value:e!=null&&e.data.province?e==null?void 0:e.data.province:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kabupaten/Kota",value:e!=null&&e.data.city?e==null?void 0:e.data.city:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kecamatan",value:e!=null&&e.data.sub_district?e==null?void 0:e.data.sub_district:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kelurahan",value:e!=null&&e.data.district?e==null?void 0:e.data.district:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Kodepos",value:e!=null&&e.data.postal_code?e==null?void 0:e.data.postal_code:"",styles:l})}),a.jsx(i.Col,{span:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Asal Sekolah",value:e!=null&&e.data.school_origin?e==null?void 0:e.data.school_origin:"",styles:l})})]})]}),a.jsxs(z,{mt:40,withBorder:!0,shadow:"lg",p:"lg",sx:o=>({backgroundColor:t?o.colors.dark[9]:"white"}),children:[a.jsxs(x,{children:[a.jsx(U,{orientation:"vertical",size:"0.5rem",color:"#2A166F"}),a.jsx(c,{weight:"bold",size:30,children:"Informasi Orang Tua"})]}),a.jsxs(i,{gutter:"lg",mt:20,children:[a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Ayah",value:e!=null&&e.data.dad_name?e==null?void 0:e.data.dad_name:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Nama Ibu",value:e!=null&&e.data.mother_name?e==null?void 0:e.data.mother_name:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Pekerjaan Ayah",value:e!=null&&e.data.dad_job?e==null?void 0:e.data.dad_job:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"Pekerjaan Ibu",value:e!=null&&e.data.mother_job?e==null?void 0:e.data.mother_job:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"No Telp Ayah",value:e!=null&&e.data.dad_phone?e==null?void 0:e.data.dad_phone:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(d,{size:"sm",readOnly:!0,label:"No Telp Ibu",value:e!=null&&e.data.mother_phone?e==null?void 0:e.data.mother_phone:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(D,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat Ayah",value:e!=null&&e.data.dad_address?e==null?void 0:e.data.dad_address:"",styles:l})}),a.jsx(i.Col,{sm:6,children:a.jsx(D,{autosize:!0,size:"sm",readOnly:!0,label:"Alamat Ibu",value:e!=null&&e.data.mother_address?e==null?void 0:e.data.mother_address:"",styles:l})}),a.jsxs(i.Col,{span:12,children:[a.jsx(c,{weight:"bold",size:18,children:"Lampiran Kartu Keluarga"}),a.jsxs(x,{py:"xs",px:"lg",bg:t?"black":"#E3E5FC",className:"rounded-md cursor-pointer",onClick:()=>{var o;h((o=e==null?void 0:e.data)==null?void 0:o.family_card)},children:[a.jsx(M,{radius:"100%",color:"#2A166F",size:45,children:a.jsx(K,{size:25})}),a.jsx(c,{size:20,weight:"bold",children:"File Kartu Keluarga"})]})]}),a.jsxs(i.Col,{span:12,children:[a.jsx(c,{weight:"bold",size:18,children:"Lampiran Akta"}),a.jsxs(x,{py:"xs",px:"lg",bg:t?"black":"#E3E5FC",className:"rounded-md cursor-pointer",onClick:()=>{var o;return h((o=e==null?void 0:e.data)==null?void 0:o.birth_card)},children:[a.jsx(M,{radius:"100%",color:"#2A166F",size:45,children:a.jsx(K,{size:25})}),a.jsx(c,{size:20,weight:"bold",children:"File Akta"})]})]})]})]})]})},ua=async n=>(await S.put("/v1/student/confirm-payment",n)).data,pa=async n=>{const{batchId:t,userId:e}=n;return(await S.get(`/v1/student/get-payments?batchId=${t}&studentId=${e}`)).data},fa=()=>{var C;const n=q(),t=aa(),{userId:e,gelombangId:l}=G(),h=ea(),[s,{open:m,close:u}]=sa(),{data:o,isFetching:j}=V({queryKey:["get_all_payment"],queryFn:()=>pa({batchId:l,userId:e})}),k=J({mutationFn:ua}),f=r=>{k.mutate(r,{onSuccess:g=>{h.invalidateQueries({queryKey:["get_all_payment"]}),h.invalidateQueries({queryKey:["get_student"]}),T.success("Success")},onError:g=>{T.error("Gagal mengkonfirmasi data")}})},v=async r=>{const g=r&&await Q(r);F.open({children:a.jsx(a.Fragment,{children:a.jsxs(b,{component:Y.Autosize,className:"overflow-auto",children:[a.jsx(b,{className:"z-50 fixed top-0 right-0 left-0",p:10,children:a.jsx(R,{ml:"auto",variant:"light",onClick:()=>{F.closeAll()},children:a.jsx(H,{size:30})})}),(g==null?void 0:g.length)>0?g.map((w,P)=>{const y=URL.createObjectURL(w);return a.jsx(Z,{src:y,imageProps:{onLoad:()=>URL.revokeObjectURL(y)}},P)}):a.jsx(b,{mt:20,p:100,sx:{justifyContent:"center",alignItems:"center"},children:a.jsx(c,{align:"center",fw:"bolder",fz:24,children:"Data kosong"})})]})}),size:"100rem",styles:{body:{padding:0},header:{display:"none"}},centered:!0})};return a.jsxs(E,{children:[j?a.jsx(a.Fragment,{children:a.jsx(O,{height:130})}):a.jsx(a.Fragment,{children:(o==null?void 0:o.data.length)>0?(C=o==null?void 0:o.data)==null?void 0:C.map(r=>{const g=new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}),w=r==null?void 0:r.image,P=r.method==="TRANSFER",y=r.method==="CASH",I=(r==null?void 0:r.status)==="PAYMENT_CONFIRMED",_=(r==null?void 0:r.status)==="WAITING_PAYMENT";return a.jsx(z,{shadow:"lg",w:"100%",withBorder:!0,p:"lg",sx:A=>({backgroundColor:n?A.colors.dark[8]:A.white,flex:1}),children:a.jsxs(E,{children:[a.jsxs(x,{grow:!0,children:[a.jsxs(x,{children:[a.jsxs(ha,{size:"md",color:I&&"green"||_&&"red",styles:{root:{backgroundColor:`${I&&!n&&"#dcfce2"||(_?n?"#3D1B1C":"#ffd1d1":"")}`}},children:[(r==null?void 0:r.status)=="PAYMENT_CONFIRMED"&&a.jsx("p",{children:"Terkonfirmasi"}),(r==null?void 0:r.status)=="WAITING_PAYMENT"&&a.jsx("p",{children:"Belum Terkonfirmasi"})]}),P&&a.jsxs(c,{weight:"bold",children:[r.bank_name," - ",r.bank_account," a/n ",r.bank_user]}),y&&a.jsx(c,{weight:"bold",children:"Tunai"})]}),a.jsx(b,{children:a.jsxs(c,{weight:"bold",align:"right",c:n?"green":"#2A166F",children:["+ ",g.format(r==null?void 0:r.total).replace(",00","")]})})]}),a.jsxs(x,{p:"lg",bg:n?t.colors.dark[5]:"#E3E5FC",children:[a.jsxs(x,{className:"rounded-md cursor-pointer flex-[2]",onClick:()=>{v(w)},children:[a.jsx(M,{radius:"100%",color:"#2A166F",size:50,children:a.jsx(K,{size:30})}),a.jsx(c,{size:20,weight:"bold",children:"File Bukti Pembayaran"})]}),a.jsx(R,{component:B,to:`http://localhost:8080/uploads/${w}`,variant:"filled",color:"#2A166F",size:50,radius:"50%",target:"_blank",children:a.jsx(ra,{size:30})})]}),a.jsx(U,{}),a.jsxs(x,{grow:!0,children:[a.jsx(c,{children:"Sabtu, 04 November 2023"}),a.jsxs(x,{position:"right",children:[r.status==="PAYMENT_CONFIRMED"&&a.jsx($,{color:"red",children:"Batalkan Konfirmasi"}),r.status==="WAITING_PAYMENT"&&a.jsx($,{onClick:()=>{F.openConfirmModal({title:"Konfirmasi Pembayaran",children:"Anda yakin ingin mengkonfirmasi pembayaran ini?",onConfirm:()=>{f({payment_id:r.id,student_id:+e})},onCancel:()=>console.log("cancel"),labels:{cancel:"Batal",confirm:"Konfirmasi"}})},children:"Konfirmasi"})]})]})]})},r.id)}):a.jsx(a.Fragment,{children:a.jsx(z,{shadow:"lg",p:"lg",withBorder:!0,children:a.jsx(c,{size:24,weight:"bold",children:"Belum ada Pembayaran"})})})}),a.jsx(la,{opened:s,onClose:()=>u()})]})},wa=async n=>{const{id:t,password:e}=n;return(await S.put("/v1/admin/update-password/student?studentId="+t,{password:e})).data},ya=()=>{const{userId:n}=G(),t=J({mutationFn:wa}),e=oa({initialValues:{password:"",confirmPassword:""},validate:{password:ma("Harap isi password password baru"),confirmPassword:xa("password","Password tidak sama")}}),l=s=>{t.mutate(s,{onSuccess:m=>{T.success("Ubah password berhasil!"),e.reset()},onError:m=>{T.error("Gagal mengubah password")}})},h=s=>{l({password:s.password,id:parseInt(n)})};return a.jsx("form",{onSubmit:e.onSubmit(h),children:a.jsxs(E,{mt:30,children:[a.jsx(c,{mt:20,fz:30,fw:600,children:"Ubah Password"}),a.jsx(W,{label:"Password Baru",...e.getInputProps("password")}),a.jsx(W,{label:"Konfirmasi Password",...e.getInputProps("confirmPassword")}),a.jsx(x,{position:"right",mt:20,children:a.jsx($,{type:"submit",loading:t.status==="pending",children:"Ubah Password"})})]})})},za=({img:n})=>{const[t,e]=L.useState(null),[l,h]=L.useState(!1),s=L.useCallback(async()=>{h(!0);try{const m=await Q(n);h(!1),e(m)}catch{h(!1),T.error("Gagal mmengambil foto profil")}},[n]);return L.useEffect(()=>{n&&s()},[n,s]),a.jsx(a.Fragment,{children:l?a.jsx(O,{circle:!0,height:200}):(t==null?void 0:t.length)>0&&t.map((m,u)=>{const o=URL.createObjectURL(m);return a.jsx(X,{src:o,imageProps:{onLoad:()=>URL.revokeObjectURL(o)},size:220,color:"cyan",sx:{border:"3px solid grey"},radius:"100%"},u)})})},Ta=()=>{var w,P,y,I,_,A;const{userId:n,gelombangId:t,tipeGelombang:e}=G(),l=q(),h=V({queryKey:["get_student"],queryFn:()=>ga({userId:n})}),{data:s,isError:m,error:u,isFetching:o}=h,j=u;if(m)return a.jsxs(z,{p:"lg",children:[a.jsx("h1",{children:((w=j==null?void 0:j.response)==null?void 0:w.status)===400?"Pendaftar tidak ditemukan":"Terjadi kesalahan"}),a.jsx(B,{className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit px-8 py-2 bg-black text-white rounded-full",to:`/ppdb/main/pendaftar-ppdb/${e}/${t}`,children:"Kembali"})]});const k=(P=s==null?void 0:s.data)==null?void 0:P.profile_picture,f=s==null?void 0:s.data.name,v=f==null?void 0:f.split(" ").map(N=>N.charAt(0).toUpperCase()).slice(0,2).join(""),C=da[(y=s==null?void 0:s.data)==null?void 0:y.status],r=new Date((I=s==null?void 0:s.data)==null?void 0:I.registrationDate),g=isNaN(r)?"Tanggal tidak valid":r.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"});return a.jsx(ia,{title:"Detail Informasi Pendaftar",children:a.jsxs(E,{className:"max-w-[60rem] mx-auto",children:[a.jsx(na,{label:"Detail Informasi Pendaftar"}),!o&&a.jsxs(B,{to:`/ppdb/main/pendaftar-ppdb/${e}/${t}`,className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit ",children:[a.jsx(ta,{color:`${l?"#9b87de":"#2A166F"}`}),a.jsx(c,{color:`${l?"#9b87de":"#2A166F"}`,children:"Kembali"})]}),a.jsxs(ja,{mt:40,p:"lg",direction:{base:"column",sm:"row"},gap:{base:"2rem",sm:"5rem"},align:"center",children:[o?a.jsx(O,{circle:!0,height:200}):k?a.jsx(a.Fragment,{children:a.jsx(za,{img:k})}):a.jsx(X,{size:220,color:"cyan",sx:{border:"3px solid grey"},radius:"100%",children:v}),a.jsxs(b,{sx:{flex:1},className:"flex flex-col gap-4",children:[a.jsx(z,{w:"100%",withBorder:!0,p:"lg",shadow:"lg",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:a.jsxs(O,{visible:o,children:[a.jsx(c,{className:"select-all",c:"white",size:24,weight:"bolder",children:s==null?void 0:s.data.name}),a.jsxs(b,{w:"fit-content",mt:10,target:"_blank",component:B,to:`https://wa.me/${(_=s==null?void 0:s.data)==null?void 0:_.phone}?text=Halo%20nak`,className:"flex items-center no-underline gap-[10px]",children:[a.jsx(M,{size:30,radius:"lg",color:"green",children:a.jsx(ca,{})}),a.jsx(c,{size:"xl",c:"teal",weight:"bold",children:(A=s==null?void 0:s.data)==null?void 0:A.phone})]}),a.jsx(c,{mt:10,className:"select-all",c:"white",weight:"bold",children:s==null?void 0:s.data.address})]})}),a.jsx(z,{withBorder:!0,p:"lg",shadow:"lg",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:a.jsxs(O,{visible:o,children:[a.jsx(c,{sx:N=>({color:N.colors.gray[3]}),weight:"bold",children:"Status"}),a.jsx(c,{color:"white",weight:"bold",size:"xl",children:C==null?void 0:C.value}),a.jsx(c,{sx:N=>({color:N.colors.gray[3]}),mt:25,weight:"bold",children:"Tanggal Mendaftar"}),a.jsx(c,{size:"xl",color:"white",weight:"bold",children:g})]})})]},s==null?void 0:s.data.id)]}),a.jsxs(p,{defaultValue:"pembayaran",styles:{tabLabel:{fontSize:"20px"}},children:[a.jsxs(p.List,{children:[a.jsx(p.Tab,{value:"pembayaran",children:"Pembayaran"}),a.jsx(p.Tab,{value:"biodata",children:"Biodata"}),a.jsx(p.Tab,{value:"ubah_password",children:"Ubah Password"})]}),a.jsx(p.Panel,{value:"pembayaran",mt:30,children:a.jsx(fa,{})}),a.jsx(p.Panel,{value:"biodata",mt:30,children:a.jsx(ba,{studentQuery:h})}),a.jsx(p.Panel,{value:"ubah_password",mt:30,children:a.jsx(ya,{})})]})]})},s==null?void 0:s.data.id)};export{Ta as default};
