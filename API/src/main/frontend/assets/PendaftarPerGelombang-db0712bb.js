import{k as y,d as R,e as O,m as V,aO as _,r as K,b as w,l as U,j as a,L as F,A as H,o as J,O as W,S as Q,bM as X,c as o,P as M,B as g,$ as p,T as Y,G as Z,f as ee}from"./index-7cb0f30c.js";import{D as ae,c as te}from"./DataTable-f3beb093.js";import{s as se}from"./statusValue-1ba5fc7f.js";import{B as ne}from"./Badge-46a18456.js";import{c as re}from"./createReactComponent-850715e9.js";import"./Flex-19fefdff.js";import"./Select-58ec8a31.js";import"./Card-dc02554a.js";var oe=re("trash","IconTrash",[["path",{d:"M4 7l16 0",key:"svg-0"}],["path",{d:"M10 11l0 6",key:"svg-1"}],["path",{d:"M14 11l0 6",key:"svg-2"}],["path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12",key:"svg-3"}],["path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3",key:"svg-4"}]]);const le=async t=>(await y.get("/v1/admin/registration-batch/get?id="+t)).data,ce=async t=>{R.get(O+"/public/get-student-to-excel?batchId="+t,{responseType:"blob"}).then(s=>{const u=s.headers["Content-Disposition"];console.log(u);const x=window.URL.createObjectURL(new Blob([s.data])),l=document.createElement("a");l.href=x,l.setAttribute("download","student_data.xls"),document.body.appendChild(l),l.click()}).catch(s=>{console.error("Gagal mengunduh file Excel:",s)})},de=async t=>(await y.get(`/v1/admin/registration-batch/get-students?batchId=${t}&page=0&size=1000`)).data,ie=async t=>(await y.get("/v1/admin/registration-batch/count-data?batchId="+t)).data,we=()=>{var k,S,D,I,v,B,E,T;const t=V(),{gelombangId:s}=_(),[u,x]=K.useState(""),{tipeGelombang:l}=_(),{data:d,isLoading:b}=w({queryKey:["get_total_pendaftar_batch"],queryFn:()=>ie(s)}),P=U({mutationFn:ce}),A=e=>{P.mutate(e,{onSuccess:n=>{console.log(n)},onError:n=>console.log(n)})},{data:r,isFetching:f,isError:L,error:$}=w({queryKey:["get_all_student_by_batch_id"],queryFn:()=>de(s)}),{data:i,isLoading:C}=w({queryKey:["get_gelombang_by_id"],queryFn:()=>le(s)}),G=(k=r==null?void 0:r.data)==null?void 0:k.totalElements,N=(S=r==null?void 0:r.data)==null?void 0:S.totalPages,m=(I=(D=r==null?void 0:r.data)==null?void 0:D.content)==null?void 0:I.map(e=>({id:(e==null?void 0:e.id)??1,nama:(e==null?void 0:e.name)??"-",noWa:(e==null?void 0:e.phone)??"-",status:(e==null?void 0:e.status)??null,tanggalMendaftar:(e==null?void 0:e.registration_Date)??null})),j=m==null?void 0:m.filter(e=>e),q=j==null?void 0:j.filter(e=>e.nama.toLowerCase().includes(u.toLowerCase()));console.log({student:r});const c=te(),z=[c.accessor(e=>e.id,{id:"Id",cell:e=>e.row.index+1,header:()=>a.jsx("span",{children:"ID"})}),c.accessor(e=>e.nama,{id:"Nama",cell:e=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:e.getValue()}),header:()=>a.jsx("span",{children:"Nama"})}),c.accessor(e=>e.noWa,{id:"No Telepon",cell:e=>e.getValue(),header:()=>a.jsx("span",{children:"No. Telepon"})}),c.accessor(e=>e.tanggalMendaftar,{id:"Tanggal Mendaftar",cell:e=>{const n=e.getValue(),h=n&&new Date(n);return n?h.toLocaleDateString("id-ID",{year:"numeric",month:"short",day:"numeric"}):"-"},header:()=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:"Tanggal Mendaftar"})}),c.accessor(e=>e.status,{id:"Status",cell:e=>{const n=e.getValue(),h=se[n];return h?a.jsx(ne,{size:"lg",color:h.color,bg:!t&&"#dcfce2",children:h.value}):"-"},header:()=>a.jsx("span",{style:{whiteSpace:"nowrap"},children:"Status"})}),c.display({id:"Detail",cell:e=>{const n=e.row.original.id;return a.jsx(F,{to:`/ppdb/main/pendaftar-ppdb/${l}/${s}/${n}`,className:"bg-blue-600 px-4 py-[3px] no-underline text-white rounded-full font-bold",children:"Detail"})},header:()=>a.jsx("span",{children:"Detail"})}),c.display({id:"Aksi",cell:e=>{const n=e.row.original.id;return a.jsx(H,{color:"red",variant:"filled",onClick:()=>console.log(n),children:a.jsx(oe,{})})},header:()=>a.jsx("span",{children:"Aksi"})})];return a.jsxs(J,{title:"Seleksi Gelombang",children:[a.jsx(W,{label:"Seleksi Gelombang"}),a.jsxs(Q,{mt:20,children:[!f&&a.jsxs(F,{to:`/ppdb/main/pendaftar-ppdb/${l}`,className:"text-xl no-underline font-bold  flex  items-center gap-2 w-fit cursor-pointer",children:[a.jsx(X,{color:`${t?"#9b87de":"#2A166F"}`}),a.jsx(o,{color:`${t?"#9b87de":"#2A166F"}`,children:"Kembali"})]}),a.jsxs(M,{withBorder:!0,p:"md",radius:"md",bg:"linear-gradient(to left bottom, #6952ba, #160942)",children:[a.jsx(g,{children:C?a.jsx(p,{height:35,w:400}):a.jsx(Y,{c:"white",order:2,children:(v=i==null?void 0:i.data)==null?void 0:v.name})}),a.jsxs(g,{bg:`${t?"#1A1B1E":"#FFFFFF"}`,sx:{padding:"0.5rem 1.5rem",marginTop:"1rem",display:"flex",gap:"2rem",borderRadius:"10px"},children:[a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Jumlah Pendaftar"}),b?a.jsx(p,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(B=d==null?void 0:d.data)==null?void 0:B.totalStudents," Orang"]})]}),a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Jumlah Penerimaan"}),b?a.jsx(p,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(E=i==null?void 0:i.data)==null?void 0:E.max_quota," Orang"]})]}),a.jsxs(g,{children:[a.jsx(o,{weight:"bold",align:"center",children:"Peserta Diterima"}),b?a.jsx(p,{height:30}):a.jsxs(o,{c:`${t?"white":"black"}`,weight:"bold",size:"xl",align:"center",children:[(T=d==null?void 0:d.data)==null?void 0:T.studentAccepted," Orang"]})]})]})]}),a.jsxs(M,{withBorder:!0,p:"md",radius:"md",children:[a.jsxs(Z,{mb:20,children:[a.jsx(o,{sx:{flex:1},size:"lg",weight:500,mb:10,children:"Data Pendaftar"}),a.jsx(ee,{onClick:()=>A(s),children:"Export Excel"})]}),L?a.jsx(o,{children:$.message}):a.jsx(ae,{data:q,canExpand:()=>!0,columns:z,loading:f,useSearchInput:!0,noCard:!0,usePagination:!1,onSearch:e=>x(e.toLowerCase()),totalRecords:G,pagination:{pageIndex:0,pageSize:1e3},pageCount:N})]})]})]})};export{we as default};
