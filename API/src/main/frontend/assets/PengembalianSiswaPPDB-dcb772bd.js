import{a5 as w,r as P,a6 as Oe,a7 as Re,a8 as ze,a9 as te,R as I,X as Ke,aa as Ue,ab as le,ac as Q,ad as Ge,ae as Ve,af as We,a as ue,m as Ye,j as e,G as me,t as $e,ag as He,c as R,S as E,_ as B,ah as n,p as j,ai as oe,k as Je,aj as Qe,l as Xe,b as W,V as pe,B as U,T as X,f as Ze,q as ea,n as aa,o as ra,O as sa,$ as ie,a0 as ta,D as la,a1 as oa,a2 as ia,ak as na,a3 as da,a4 as ca}from"./index-7cb0f30c.js";import{F as ua}from"./index.esm-de00fa2d.js";import{D as G,I as ma,e as pa,R as ha,f as ga,h as xa,i as fa,u as ba,g as ja,T as _a,S as va,a as ka,b as ya,c as Pa,d as Da}from"./generateQueryParam-993c049b.js";import{u as he,C as O,F as Sa}from"./FormWrapper-27f535ba.js";import{H as Ia}from"./index.esm-fbceaefa.js";import{I as ne}from"./Image-9a78668e.js";import{S as wa}from"./SimpleGrid-44ad311c.js";import{T as Z}from"./Textarea-e2def8bf.js";import{R as Ca}from"./ResponseError-252f1eaa.js";import{c as L}from"./imageUtils-86f0f647.js";import{L as Na}from"./LoadingOverlay-7dce2269.js";import"./DataTable-f3beb093.js";import"./Flex-19fefdff.js";import"./Select-58ec8a31.js";import"./Card-dc02554a.js";import"./Badge-46a18456.js";function qa({date:r,maxDate:t,minDate:a}){return!(r==null||Number.isNaN(r.getTime())||t&&w(r).isAfter(t,"date")||a&&w(r).isBefore(a,"date"))}function Aa(r){const t=new Date(r);return Number.isNaN(t.getTime())||!r?null:t}var Ta=Object.defineProperty,La=Object.defineProperties,Ea=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,ge=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable,de=(r,t,a)=>t in r?Ta(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,q=(r,t)=>{for(var a in t||(t={}))ge.call(t,a)&&de(r,a,t[a]);if(Y)for(var a of Y(t))xe.call(t,a)&&de(r,a,t[a]);return r},V=(r,t)=>La(r,Ea(t)),Ba=(r,t)=>{var a={};for(var o in r)ge.call(r,o)&&t.indexOf(o)<0&&(a[o]=r[o]);if(r!=null&&Y)for(var o of Y(r))t.indexOf(o)<0&&xe.call(r,o)&&(a[o]=r[o]);return a};const Fa={valueFormat:"MMMM D, YYYY",fixOnBlur:!0,preserveTime:!0,size:"sm"},fe=P.forwardRef((r,t)=>{const a=Oe("DateInput",Fa,r),{inputProps:o,wrapperProps:h,value:i,defaultValue:x,onChange:g,clearable:f,clearButtonProps:_,popoverProps:p,getDayProps:u,locale:v,valueFormat:b,dateParser:k,minDate:s,maxDate:l,fixOnBlur:d,onFocus:m,onBlur:D,onClick:y,readOnly:S,name:$,form:be,rightSection:je,unstyled:ae,classNames:_e,styles:ve,allowDeselect:re,preserveTime:ke,date:ye,defaultDate:Pe,onDateChange:De}=a,Se=Ba(a,["inputProps","wrapperProps","value","defaultValue","onChange","clearable","clearButtonProps","popoverProps","getDayProps","locale","valueFormat","dateParser","minDate","maxDate","fixOnBlur","onFocus","onBlur","onClick","readOnly","name","form","rightSection","unstyled","classNames","styles","allowDeselect","preserveTime","date","defaultDate","onDateChange"]),{calendarProps:Ie,others:we}=Re(Se),H=ze(),Ce=k||(c=>{const C=w(c,b,H.getLocale(v)).toDate();return Number.isNaN(C.getTime())?Aa(c):C}),Ne=re!==void 0?re:f,F=c=>c?w(c).locale(H.getLocale(v)).format(b):"",[N,z,K]=te({value:i,defaultValue:x,finalValue:null,onChange:g}),[qe,J]=te({value:ye,defaultValue:x||Pe,finalValue:null,onChange:De});P.useEffect(()=>{K&&J(i)},[K,i]);const[Ae,A]=P.useState(F(N));P.useEffect(()=>{A(F(N))},[H.getLocale(v)]);const[se,M]=P.useState(!1),Te=c=>{const C=c.currentTarget.value;if(A(C),C.trim()===""&&f)z(null);else{const T=Ce(C);qa({date:T,minDate:s,maxDate:l})&&(z(T),J(T))}},Le=c=>{D==null||D(c),M(!1),d&&A(F(N))},Ee=c=>{m==null||m(c),M(!0)},Be=c=>{y==null||y(c),M(!0)},Fe=c=>V(q({},u==null?void 0:u(c)),{selected:w(N).isSame(c,"day"),onClick:()=>{const C=ke?We(N,c):c,T=f&&Ne&&w(N).isSame(c,"day")?null:C;z(T),!K&&A(F(T)),M(!1)}}),Me=je||(f&&N&&!S?I.createElement(Ke,q({variant:"transparent",onMouseDown:c=>c.preventDefault(),tabIndex:-1,onClick:()=>{z(null),!K&&A(""),M(!1)},unstyled:ae},_)):null);return Ue(()=>{i!==void 0&&!se&&A(F(i))},[i]),I.createElement(I.Fragment,null,I.createElement(le.Wrapper,V(q({},h),{__staticSelector:"DateInput"}),I.createElement(Q,q({opened:se,trapFocus:!1,position:"bottom-start",disabled:S,withRoles:!1},p),I.createElement(Q.Target,null,I.createElement(le,V(q(q({"data-dates-input":!0,"data-read-only":S||void 0,autoComplete:"off",ref:t,value:Ae,onChange:Te,onBlur:Le,onFocus:Ee,onClick:Be,readOnly:S,rightSection:Me},o),we),{__staticSelector:"DateInput"}))),I.createElement(Q.Dropdown,{onMouseDown:c=>c.preventDefault(),"data-dates-dropdown":!0},I.createElement(Ge,V(q({__staticSelector:"DateInput"},Ie),{classNames:_e,styles:ve,unstyled:ae,__preventFocus:!0,minDate:s,maxDate:l,locale:v,getDayProps:Fe,size:o.size,date:qe,onDateChange:J}))))),I.createElement(Ve,{name:$,form:be,value:N,type:"default"}))});fe.displayName="@mantine/dates/DateInput";const ee=({onChange:r,onReject:t,onDrop:a,accept:o,multiple:h,value:i,label:x})=>{const g=ue(),f=Ye();return console.log({valueDropZone:i}),e.jsxs(G,{multiple:h,onChange:r,onReject:t,maxSize:3*1024**2,accept:o,onDrop:a,children:[e.jsxs(me,{position:"center",spacing:"xl",style:{minHeight:$e(220),pointerEvents:"none",position:"relative",overflow:"hidden"},children:[e.jsx(G.Accept,{children:e.jsx(He,{size:"3.2rem",color:g.colors[g.primaryColor][g.colorScheme==="dark"?4:6]})}),e.jsx(G.Reject,{children:e.jsx(ma,{size:"3.2rem",color:g.colors.red[g.colorScheme==="dark"?4:6]})}),e.jsx(G.Idle,{children:e.jsx(Ia,{size:"3.2rem"})}),e.jsx(R,{sx:{zIndex:9,color:i&&!h?"transparent":f?"white":"black"},children:x}),!h&&i&&(i==null?void 0:i.length)>0&&i.map((_,p)=>{const u=URL.createObjectURL(_);return e.jsx(ne,{src:u,width:"80%",sx:{position:"absolute",filter:"brightness(50%)",top:0},imageProps:{onLoad:()=>URL.revokeObjectURL(u)}},p)})]}),e.jsx(wa,{cols:4,mt:5,breakpoints:[{maxWidth:"sm",cols:1}],children:h&&i&&o===pa&&i.map((_,p)=>{const u=URL.createObjectURL(_);return e.jsx(ne,{src:u,w:20,imageProps:{onLoad:()=>URL.revokeObjectURL(u)}},p)})})]})},Ma=()=>{var o,h,i,x,g,f,_,p,u,v,b,k,s,l,d;const{register:r,control:t,formState:{errors:a}}=he();return console.log({errors:a}),console.log((o=a==null?void 0:a.profile_picture)==null?void 0:o.message),e.jsxs(E,{spacing:10,children:[e.jsx(O,{render:({field:{onChange:m,value:D}})=>e.jsx(ee,{children:e.jsx("div",{}),label:"Upload pas Photo 3x4, Max : 5MB (DIBUTUHKAN)",onDrop:y=>{m(y)},accept:{"image/*":[]},value:D,multiple:!1,onChange:y=>{var S;return m(((S=y.target.files)==null?void 0:S[0])??null)},onReject:y=>{y[0].errors[0].code=="file-too-large"&&B.error("Size gambar terlalu besar dari 5MB")}}),name:"profile_picture",control:t,rules:{required:{value:!0,message:"Dibutuhkan"}}}),e.jsx(R,{size:"xs",c:"red",children:(h=a==null?void 0:a.profile_picture)==null?void 0:h.message}),e.jsxs(n,{children:[e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Masukkan NISN",label:"NISN",withAsterisk:!1,placeholder:"Nomor NISN",error:a.nisn&&e.jsx("div",{children:(i=a.nisn)==null?void 0:i.message}),required:!0,...r("nisn",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{disabled:!0,description:"Nomor Whatsapp",label:"Nomor WhatsApp",placeholder:"Nomor Whatsapp",error:a.phone&&e.jsx("div",{children:(x=a.phone)==null?void 0:x.message}),required:!0,...r("phone",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nama Lengkap",label:"Nama Lengkap",placeholder:"Nama Lengkap",error:a.name&&e.jsx("div",{children:(g=a.name)==null?void 0:g.message}),required:!0,...r("name",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nama Panggilan",label:"Nama Panggilan",withAsterisk:!1,placeholder:"Nama Panggilan",error:a.surname&&e.jsx("div",{children:(f=a.surname)==null?void 0:f.message}),required:!0,...r("surname",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(ha,{name:"gender",control:t,label:"Gender",rules:{required:{value:!0,message:"Dibutuhkan"}},description:"Pilih salah satu",children:e.jsxs(me,{mt:"xs",children:[e.jsx(oe,{value:"L",label:"Laki laki"}),e.jsx(oe,{value:"P",label:"Perempuan"})]})})}),e.jsxs(n.Col,{lg:6,sm:12,children:[e.jsx(O,{render:({field:{onChange:m,value:D}})=>e.jsx(ga,{type:"RELIGION",readOnly:!1,label:"Agama",onChange:m,value:D,searchable:!1}),name:"religion",control:t,rules:{required:{value:!0,message:"Dibutuhkan"}}}),e.jsx(R,{c:"red",size:"xs",children:(_=a==null?void 0:a.religion)==null?void 0:_.message})]}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Tempat Lahir",placeholder:"Tempat Lahir",error:a.birth_place&&e.jsx("div",{children:(p=a.birth_place)==null?void 0:p.message}),required:!0,...r("birth_place",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(O,{render:({field:{onChange:m,value:D},fieldState:{error:y}})=>e.jsx(fe,{error:y==null?void 0:y.message,value:D,onChange:S=>{const $=new Date(S);m($)},label:"Tanggal Lahir",placeholder:"Tanggal Lahir",styles:{calendar:{maxWidth:"500px"},calendarHeader:{marginInline:"auto"}}}),name:"birth_date",control:t,rules:{required:{value:!0,message:"Dibutuhkan"}}})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(Z,{label:"Alamat",autosize:!0,minRows:3,placeholder:"Alamat",error:a.address&&e.jsx("div",{children:(u=a.address)==null?void 0:u.message}),required:!0,...r("address",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Provinsi",placeholder:"Provinsi",error:a.province&&e.jsx("div",{children:(v=a.province)==null?void 0:v.message}),required:!0,...r("province",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Kota/Kabupaten",placeholder:"Kota/Kabupaten",error:a.city&&e.jsx("div",{children:(b=a.city)==null?void 0:b.message}),required:!0,...r("city",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Kecamatan",placeholder:"Kecamatan",error:a.district&&e.jsx("div",{children:(k=a.district)==null?void 0:k.message}),required:!0,...r("district",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Kelurahan",placeholder:"Kelurahan",error:a.sub_district&&e.jsx("div",{children:(s=a.sub_district)==null?void 0:s.message}),required:!0,...r("sub_district",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Kode Pos",placeholder:"Kode Pos",withAsterisk:!1,error:a.postal_code&&e.jsx("div",{children:(l=a.postal_code)==null?void 0:l.message}),required:!0,...r("postal_code",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{label:"Asal Sekolah",placeholder:"Asal Sekolah",error:a.school_origin&&e.jsx("div",{children:(d=a.school_origin)==null?void 0:d.message}),required:!0,...r("school_origin",{required:{value:!0,message:"Dibutuhkan"}})})})]})]})},Oa=()=>{var o,h,i,x,g,f,_,p,u,v;ue();const{register:r,control:t,formState:{errors:a}}=he();return e.jsxs(E,{spacing:10,children:[e.jsxs(n,{children:[e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nama Ayah",label:"Nama Ayah",placeholder:"Nama Ayah",error:a.dad_name&&e.jsx("div",{children:(o=a.dad_name)==null?void 0:o.message}),required:!0,...r("dad_name",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nama Ibu",label:"Nama Ibu",placeholder:"Nama Ibu",error:a.mother_name&&e.jsx("div",{children:(h=a.mother_name)==null?void 0:h.message}),required:!0,...r("mother_name",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Pekerjaan Ayah",label:"Pekerjaan Ayah",withAsterisk:!1,placeholder:"Pekerjaan Ayah",error:a.dad_job&&e.jsx("div",{children:(i=a.dad_job)==null?void 0:i.message}),required:!0,...r("dad_job",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Pekerjaan Ibu",label:"Pekerjaan Ibu",placeholder:"Pekerjaan Ibu",withAsterisk:!1,error:a.mother_job&&e.jsx("div",{children:(x=a.mother_job)==null?void 0:x.message}),required:!0,...r("mother_job",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nomor Telepon Ayah",label:"Nomor Telepon Ayah",placeholder:"Nomor Telepon Ayah",error:a.dad_phone&&e.jsx("div",{children:(g=a.dad_phone)==null?void 0:g.message}),required:!0,...r("dad_phone",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(j,{description:"Nomor Telepon Ibu",label:"Nomor Telepon Ibu",placeholder:"Nomor Telepon Ibu",error:a.mother_phone&&e.jsx("div",{children:(f=a.mother_phone)==null?void 0:f.message}),required:!0,...r("mother_phone",{required:{value:!0,message:"Dibutuhkan"}})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(Z,{label:"Alamat Ayah",autosize:!0,minRows:3,placeholder:"Alamat Ayah",error:a.dad_address&&e.jsx("div",{children:(_=a.dad_address)==null?void 0:_.message}),withAsterisk:!1,required:!0,...r("dad_address",{required:!1})})}),e.jsx(n.Col,{lg:6,sm:12,children:e.jsx(Z,{label:"Alamat Ibu",autosize:!0,minRows:3,placeholder:"Alamat Ibu",error:a.mother_address&&e.jsx("div",{children:(p=a.mother_address)==null?void 0:p.message}),withAsterisk:!1,required:!0,...r("mother_address",{required:!1})})})]}),e.jsx(O,{render:({field:{onChange:b,value:k}})=>e.jsx(ee,{children:e.jsx("div",{}),label:"Upload kartu Keluarga 3x4, Max : 5MB ( WAJIB )",onDrop:s=>{b(s)},value:k,multiple:!1,onChange:s=>{var l;return b(((l=s.target.files)==null?void 0:l[0])??null)},onReject:s=>{s[0].errors[0].code=="file-too-large"&&B.error("Size gambar terlalu besar dari 5MB")}}),name:"family_card",control:t,rules:{required:{value:!0,message:"Dibutuhkan"}}}),e.jsx(R,{size:"xs",c:"red",children:(u=a==null?void 0:a.family_card)==null?void 0:u.message}),e.jsx(O,{render:({field:{onChange:b,value:k}})=>e.jsx(ee,{children:e.jsx("div",{}),label:" Upload akta kelahiran 3x4, Max : 5MB ( WAJIB )",onDrop:s=>{b(s)},value:k,multiple:!1,onChange:s=>{var l;return b(((l=s.target.files)==null?void 0:l[0])??null)},onReject:s=>{s[0].errors[0].code=="file-too-large"&&B.error("Size gambar terlalu besar dari 5MB")}}),rules:{required:{value:!0,message:"Dibutuhkan"}},name:"birth_card",control:t}),e.jsx(R,{size:"xs",c:"red",children:(v=a==null?void 0:a.birth_card)==null?void 0:v.message})]})},Ra=async r=>(await Je.put("/v1/student/update-bio",r)).data,za=({type:r="PENGEMBALIAN"})=>{var b,k;const[t,a]=P.useState(!1),o=xa({step:3,stagingId:null}),[h,i]=P.useState(null),x=Qe(),g=Xe({mutationFn:Ra});console.log("============STEP BIODATAAA============"),console.log({initialValues:h});const{data:f}=W({queryKey:["get-session-from-bio"],queryFn:pe});console.log({data:f});const _=s=>{const l=new FormData;for(const[d,m]of Object.entries(s))m!==null&&(d==="profile_picture"||d==="family_card"||d==="birth_card"?l.append(d,m==null?void 0:m[0]):d==="birth_date"?l.append(d,w(m).format("YYYY-MM-DD")):l.append(d,m));g.mutate(l,{onSuccess:()=>{B.success("Sukses update informasi biodata"),x.invalidateQueries({queryKey:["get_last_offset_batch"]})},onError:d=>Ca(d)})},{data:p,isSuccess:u}=W({queryKey:["student_staging_offset",o.stagingId,r],queryFn:()=>fa(o.stagingId,r),enabled:!!o.stagingId}),v=async()=>{var l;const s=(l=p.data)==null?void 0:l.student;if(a(!0),console.log({student:s}),typeof(s==null?void 0:s.profile_picture)=="string")try{s.profile_picture=await L(s.profile_picture),s.birth_card=await L(s.birth_card),s.family_card=await L(s.family_card),console.log("-----------SEBELUM INIT-----------"),console.log({student:s}),i({...s,birth_date:s.birth_date?w(s.birth_date).toDate():null}),a(!1)}catch{a(!1),B.error("Gagal mengambil data biodata, silakan coba lagi")}else if((s==null?void 0:s.profile_picture)===null)console.log("null"),i({...s,birth_date:s.birth_date?w(s.birth_date).toDate():null}),a(!1);else try{s.profile_picture=await L(s.profile_picture[0].name),s.birth_card=await L(s.birth_card[0].name),s.family_card=await L(s.family_card[0].name),console.log("-----------SEBELUM INIT-----------"),console.log({student:s}),i({...s,birth_date:s.birth_date?w(s.birth_date).toDate():null}),a(!1)}catch{a(!1),B.error("Gagal mengambil data biodata, silakan coba lagi")}};return P.useEffect(()=>{u&&v()},[u]),e.jsx(Sa,{id:"form-biodata",initialValues:h,onSubmit:_,children:u&&((b=p.data.current_state)==null?void 0:b.status)==="WAITING_PAYMENT"&&((k=p.data.current_state)==null?void 0:k.type)===r?e.jsx(U,{sx:s=>({backgroundColor:`${s.colorScheme==="dark"?s.colors.dark[7]:s.white}`,padding:"2rem",boxShadow:"0 5px 10px -8px black",borderRadius:"7px"}),children:e.jsxs(E,{children:[e.jsx(X,{children:"Isi Biodata"}),e.jsx("p",{children:"Harap menunggu konfirmasi pembayaran terlebih dahulu sebelum isi biodata"})]})}):e.jsx(e.Fragment,{children:e.jsxs(U,{pos:"relative",children:[e.jsx(U,{sx:s=>({backgroundColor:`${s.colorScheme==="dark"?s.colors.dark[7]:s.white}`,padding:"2rem",boxShadow:"0 5px 10px -8px black",borderRadius:"7px"}),children:e.jsxs(E,{children:[e.jsx(X,{children:"Isi Biodata"}),e.jsx(Ma,{})]})}),e.jsx(U,{sx:s=>({backgroundColor:`${s.colorScheme==="dark"?s.colors.dark[7]:s.white}`,marginTop:10,padding:"2rem",boxShadow:"0 5px 10px -8px black",borderRadius:"7px"}),children:e.jsxs(E,{children:[e.jsx(X,{children:"Informasi Orang Tua"}),e.jsx(Oa,{}),e.jsx(Ze,{type:"submit",variant:"filled",loading:g.isPending,children:"Submit"})]})}),e.jsx(Na,{visible:t,zIndex:10})]})})})};function Ka(r){const{grade:t}=r;return e.jsx(oa,{unstyled:!0,styles:a=>({tab:{...a.fn.focusStyles(),backgroundColor:a.colorScheme==="dark"?a.colors.dark[6]:a.white,color:a.colorScheme==="dark"?"white":a.colors.gray[9],border:"0.1625rem solid #dee2e6",boxShadow:"0 10px 20px -10px rgba(0,0,0,0.2)",cursor:"pointer",fontSize:a.fontSizes.sm,borderRadius:"5px","&:disabled":{cursor:"not-allowed",color:a.colorScheme==="dark"?a.colors.gray[4]:a.colors.gray[8],backgroundColor:a.colorScheme==="dark"?a.colors.dark[6]:a.colors.gray[4]},"&[data-active]":{background:`linear-gradient(45deg, ${t=="SMP"&&"#2A166F"||t=="SMK"&&"#FF6C22"}, ${t=="SMP"&&"#6548DB"||t=="SMK"&&"#ff9f22"})`,borderColor:"green",color:a.white,boxShadow:"0 10px 20px -10px rgba(0,0,0,0.5)"}},tabsList:{overflowX:"auto"}}),...r})}const ce=[{index:1,label:"Pilih Jalur PPDB",icon:ia,content:e.jsx(va,{type:"PENGEMBALIAN"})},{index:2,label:"Transaksi Pengembalian",icon:ua,content:e.jsx(ka,{type:"PENGEMBALIAN"})},{index:3,label:"Isi Biodata",icon:na,content:e.jsx(za,{type:"PENGEMBALIAN"})},{index:4,label:"Pilih Jurusan",icon:da,content:e.jsx(ya,{type:"PENGEMBALIAN"})},{index:5,label:"Cetak Kartu Peserta",icon:ca,content:e.jsx(Pa,{type:"PENGEMBALIAN"})}],or=()=>{var v,b,k,s;const[r,t]=P.useState({step:1,stagingId:null}),{data:a,isSuccess:o,isFetching:h}=W({queryKey:["get_last_offset_batch"],queryFn:()=>Da("PENGEMBALIAN"),staleTime:0,notifyOnChangeProps:"all"}),{data:i}=W({queryFn:pe,queryKey:["session"]}),x=ba(r),g=ea(),f=aa(),_=(b=(v=i==null?void 0:i.data)==null?void 0:v.student)==null?void 0:b.grade;P.useEffect(()=>{t(x==null?void 0:x.initialValues)},[x]),P.useEffect(()=>{if(o){const l=a.data.filter(d=>d.is_done===1);if(l.length>0)if(a.data[a.data.length-1].index!==l[l.length-1].index){const d=l[l.length-1].index+1;p(d.toString())}else p(l[l.length-1].index.toString());else p("1")}},[a,o]);const p=l=>{var m;const d={step:+l,stagingId:(m=a.data.find(D=>D.index===+l))==null?void 0:m.id};f(`${g.pathname}?${ja(d)}`)},u=o&&((k=a==null?void 0:a.data)==null?void 0:k.filter(l=>(l==null?void 0:l.grade)===_));return e.jsxs(ra,{title:"Pengembalian",children:[e.jsx(sa,{label:"Pengembalian"}),e.jsx(E,{className:"style-box max-w-[100rem] mx-auto",children:e.jsxs(Ka,{value:`${r.step}`,onTabChange:p,grade:_,children:[h?e.jsx(ie,{mt:40,width:"100%",height:200,visible:!0}):e.jsx(e.Fragment,{children:o&&e.jsx(ta,{w:"100%",display:"flex",type:"always",sx:{display:"block"},offsetScrollbars:!0,children:e.jsx(_a,{activeTabIndex:+r.step,card:u==null?void 0:u.map((l,d)=>{var m;return{label:l.name,index:l.index,icon:(m=ce[d])==null?void 0:m.icon,is_done:l.is_done===1}})})})}),e.jsx(la,{my:20}),h?e.jsx(ie,{mt:40,width:"100%",height:200,visible:!0}):e.jsx(e.Fragment,{children:(s=ce.find(l=>l.index===r.step))==null?void 0:s.content})]})})]})};export{or as default};
