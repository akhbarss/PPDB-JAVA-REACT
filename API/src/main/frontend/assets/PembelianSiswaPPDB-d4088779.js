import{r as d,b as f,e as S,g as y,j as s,v as P,aa as m,S as j,D as k,x as h,ab as w,ac as v,ad as C,ae as F}from"./index-dba9ce5e.js";import{u as E,g as L,S as T,T as I,a as _,F as B,b as D,c as M,d as N,e as R}from"./StepPilihJurusan-1cd050fd.js";import"./ResponseError-bd25342d.js";import"./LoadingOverlay-7e2a36f3.js";import"./FormWrapper-618247dc.js";const A=t=>s.jsx(w,{unstyled:!0,styles:a=>({tab:{...a.fn.focusStyles(),backgroundColor:a.colorScheme==="dark"?a.colors.dark[6]:a.white,color:a.colorScheme==="dark"?"white":a.colors.gray[9],border:"none",boxShadow:"0 10px 20px -10px rgba(0,0,0,0.2)",cursor:"pointer",fontSize:a.fontSizes.sm,borderRadius:"5px","&:disabled":{cursor:"not-allowed",color:a.colorScheme==="dark"?a.colors.gray[4]:a.colors.gray[8],backgroundColor:a.colorScheme==="dark"?a.colors.dark[6]:a.colors.gray[4]},"&[data-active]":{background:"linear-gradient(45deg, #4c6ef5 0%, #15aabf 100%)",borderColor:a.colors.blue[7],color:a.white,boxShadow:"0 10px 20px -10px rgba(0,0,0,0.5)"}},tabsList:{overflowX:"auto"}}),...t}),b=[{index:1,label:"Pilih Gelombang PPDB",icon:v,content:s.jsx(_,{type:"PEMBELIAN"})},{index:2,label:"Transaksi Pembelian",icon:B,content:s.jsx(D,{})},{index:3,label:"Pilih Jurusan",icon:C,content:s.jsx(M,{})},{index:4,label:"Cetak Kartu Peserta",icon:F,content:s.jsx(N,{})}],O=()=>{var x;const[t,a]=d.useState({step:1,stagingId:null}),{data:n,isLoading:u,isSuccess:c}=f({queryKey:["get_last_offset_batch"],queryFn:()=>R("PEMBELIAN"),staleTime:0,notifyOnChangeProps:"all"}),r=E(t),g=S(),p=y();d.useEffect(()=>{a(r==null?void 0:r.initialValues)},[r]),d.useEffect(()=>{if(c){const e=n.data.filter(o=>o.is_done===1);if(e.length>0)if(n.data[n.data.length-1].index!==e[e.length-1].index){const o=e[e.length-1].index+1;i(o.toString())}else i(e[e.length-1].index.toString());else i("1")}},[n,c]);const i=e=>{const o={step:+e,stagingId:n.data.find(l=>l.index===+e).id};a(o),p(`${g.pathname}?${L(o)}`)};return s.jsxs(P,{title:"Pembelian",children:[s.jsx(m,{label:"Pembelian"}),s.jsx(j,{className:"style-box max-w-[70rem] mx-auto",children:s.jsxs(A,{value:`${t.step}`,onTabChange:i,children:[u&&s.jsx(T,{width:"100%"}),c&&s.jsx(I,{activeTabIndex:+t.step,card:n.data.map((e,o)=>{var l;return{label:e.name,index:e.index,icon:(l=b[o])==null?void 0:l.icon,is_done:e.is_done===1}})}),s.jsx(k,{my:20}),(x=b.find(e=>e.index===t.step))==null?void 0:x.content]})}),s.jsx(h,{position:"top-center",reverseOrder:!1})]})};export{O as default};
