import{k as S,j as e,aL as se,S as ne,p as P,ah as q,bE as K,G as I,f as w,aA as z,N as re,b as oe,l as A,P as Z,bF as ke,B as le,c as j,L as be,bG as H,A as ee,bH as xe,aI as de,T as ue,_ as k,aD as je,m as ge,aO as De,a as we,o as fe,$ as Ce,aM as Te,aN as Ie}from"./index-7cb0f30c.js";import{b as ye}from"./index.esm-de00fa2d.js";import{A as W,e as Pe,C as Se}from"./index.esm-74ecb24c.js";import{T as ae}from"./ThemeIcon-75a01779.js";import{B as ce}from"./Badge-46a18456.js";import{S as _e}from"./Select-58ec8a31.js";const Ue=async t=>{const{idJalur:s,payloadCreate:o}=t,m={...o,path_id:s};return console.log(m),(await S.post("/v1/admin/registration-batch/post",m)).data},Ge=async t=>(console.log(t),(await S.delete("/v1/admin/registration-batch/delete?id="+t.id)).data),ve=async t=>{const{id:s,bank_account:o,bank_name:m,bank_user:b,end_date:g,index:l,max_quota:f,name:d,price:_,start_date:c,batchCode:h}=t,u={bank_account:o,bank_name:m,bank_user:b,start_date:c,end_date:g,index:l,max_quota:f,name:d,price:_,batchCode:h};return console.log(u),(await S.patch("/v1/admin/registration-batch/update?id="+s,u)).data},Be=async t=>(await S.get("/v1/admin/registration-batch/get-batch-by-pathsId?pathsId="+t)).data,Ee=async t=>(await S.post("/v1/user/exam-information/create",t)).data,Fe=async t=>{const{id:s}=t;return(await S.delete("/v1/user/exam-information/delete?id="+s)).data},qe=async t=>{const{id:s,...o}=t;return(await S.patch("/v1/user/exam-information/update?id="+s,o)).data},ze=async t=>(await S.get("/v1/user/exam-information/index?batchId="+t)).data,te=({action:{actionFn:t,label:s},formMantine:o,close:m,loading:b,opened:g,title:l})=>{const f=d=>{console.log(d),t(d)};return e.jsx(se,{onClose:m,opened:g,size:"40rem",title:l,withFooter:!1,children:e.jsxs("form",{onSubmit:o.onSubmit(d=>f(d)),children:[e.jsxs(ne,{p:20,pb:"6rem",children:[e.jsx(P,{required:!0,label:"Nama Test Ujian",...o.getInputProps("nama")}),e.jsx(P,{required:!0,label:"Link Test Ujian",...o.getInputProps("link")}),e.jsxs(q,{children:[e.jsx(q.Col,{md:6,children:e.jsx(K,{withAsterisk:!0,"aria-required":"true",label:"Waktu Pendaftaran Dibuka",dropdownType:"modal",...o.getInputProps("waktuDibuka"),clearable:!0})}),e.jsx(q.Col,{md:6,children:e.jsx(K,{required:!0,label:"Waktu Pendaftaran Ditutup",dropdownType:"modal",...o.getInputProps("waktuDitutup"),clearable:!0})})]})]}),e.jsxs(I,{position:"right",sx:d=>({position:"absolute",bottom:0,right:0,left:0,padding:"1rem 4rem",backgroundColor:d.colorScheme==="dark"?"black":"whitesmoke",zIndex:1}),children:[e.jsx(w,{variant:"outline",onClick:()=>m(),disabled:b,children:"Batal"}),e.jsx(w,{type:"submit",loading:b,children:s})]})]})})},Ae=({idGelombang:t})=>{const[s,{open:o,close:m}]=z(!1),[b,{open:g,close:l}]=z(!1),[f,{open:d,close:_}]=z(!1),c=re({initialValues:{id:null,link:"",nama:"",waktuDibuka:null,waktuDitutup:null},transformValues:a=>({...a,waktuDibuka:a.waktuDibuka.toISOString(),waktuDitutup:a.waktuDitutup.toISOString()}),validate:{waktuDibuka:a=>a===null?"Tolong masukkan waktu dibuka":null,waktuDitutup:a=>a===null?"Tolong masukkan waktu ditutup":null}}),{data:h,refetch:u}=oe({queryKey:["get_test_ujian"+t],queryFn:()=>ze(t)}),p=A({mutationFn:Ee}),R=A({mutationFn:Fe}),v=A({mutationFn:qe});function V(a){p.mutate(a,{onSuccess:r=>{console.log(r),u(),k.success("Data berhasil ditambahkan"),m(),c.reset()},onError:r=>{k.error("Data gagal ditambahkan"),console.log(r)}})}function M(a){const{link:r,nama:x,waktuDibuka:D,waktuDitutup:B}=a;V({link:r,title:x,batchId:t,endDate:B,startDate:D})}function N(a){v.mutate(a,{onSuccess:r=>{console.log(r),u(),l(),k.success("Data berhasil diubah"),c.reset()},onError:r=>{console.log(r),k.error("Data gagal diubah")}})}function Q(a){const{link:r,nama:x,waktuDibuka:D,waktuDitutup:B,id:E}=a;N({id:E,link:r,title:x,endDate:B,startDate:D})}function X(a){R.mutate(a,{onSuccess:r=>{console.log(r),u(),k.success("Data berhasil dihapus"),_(),c.reset()},onError:r=>{console.log(r),k.error("Gagal menghapus data")}})}return e.jsxs(e.Fragment,{children:[(h==null?void 0:h.data)&&(h==null?void 0:h.data.sort((a,r)=>a.id-r.id).map((a,r)=>{const x=a!=null&&a.startDate?new Date(a==null?void 0:a.startDate):null,D=a!=null&&a.endDate?new Date(a==null?void 0:a.endDate):null,E=new Date>=x&&x<=D,J=x?x.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",$=D?D.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date";return e.jsx(Z,{withBorder:!0,p:"1rem",sx:n=>({backgroundColor:n.colorScheme==="dark"?n.colors.dark[9]:n.colors["brand-smp"][0],display:"flex",justifyContent:"space-between",alignItems:"center"}),children:e.jsxs(I,{align:"start",w:"100%",children:[e.jsxs(I,{sx:{flex:2},children:[e.jsx(ae,{radius:"100%",size:50,mx:"sm",children:e.jsx(ke,{size:30})}),e.jsxs(le,{sx:{flex:2},children:[e.jsx(j,{size:16,weight:"bolder",children:a.title}),e.jsxs(j,{children:[J," â€“ ",$]}),e.jsxs(j,{children:["Link Tes Online : ",e.jsx(j,{target:"_blank",c:"blue",component:be,to:a.link&&a.link,children:a.link&&a.link})]})]})]}),e.jsxs(I,{children:[e.jsx(ce,{variant:"light",color:`${E?"green":"red"}`,size:"lg",children:E?"Dibuka":"Ditutup"}),e.jsxs(H,{withArrow:!0,width:100,position:"left-start",onOpen:()=>{c.setValues({id:a.id,nama:a.title})},onClose:()=>{console.log("close")},children:[e.jsx(H.Target,{children:e.jsx(ee,{variant:"transparent",children:e.jsx(xe,{size:30})})}),e.jsxs(H.Dropdown,{children:[e.jsx(H.Item,{onClick:()=>{g(),c.setValues({id:a.id,nama:a.title,waktuDibuka:x,waktuDitutup:D,link:a.link})},children:"Edit"}),e.jsx(H.Item,{onClick:()=>{d()},children:"Delete"})]})]})]})]})},a!=null&&a.id?a.id:r)})),e.jsx(w,{onClick:()=>o(),children:"Tambah Ujian"}),e.jsx(te,{formMantine:c,action:{label:"Tambah",actionFn:M},close:()=>{m(),c.reset()},loading:p.status==="pending",opened:s,title:"Tambah Tes Ujian"}),e.jsx(te,{formMantine:c,action:{label:"Ubah",actionFn:Q},close:()=>{l(),c.reset()},loading:v.status==="pending",opened:b,title:"Ubah Tes Ujian"}),e.jsxs(de,{centered:!0,closeOnEscape:!1,closeOnClickOutside:!1,withCloseButton:!1,opened:f,onClose:()=>{_(),c.reset()},children:[e.jsx(ue,{order:3,children:"Hapus Tes Ujian"}),e.jsxs(j,{mt:20,children:["Anda yakin ingin menghapus tes ujian ",c.values.nama,"?"]}),e.jsxs(I,{mt:20,position:"right",children:[e.jsx(w,{disabled:R.status==="pending",variant:"outline",onClick:()=>{_(),c.reset()},children:"Batal"}),e.jsx(w,{variant:"danger",onClick:()=>X({id:c.values.id}),loading:R.status==="pending",children:"Hapus"})]})]})]})},ie=({title:t,close:s,opened:o,action:{actionFn:m,label:b},loading:g,formMantine:l})=>{function f(d){m(d)}return e.jsx(se,{onClose:s,opened:o,size:"40rem",title:t,withFooter:!1,children:e.jsxs("form",{onSubmit:l.onSubmit(d=>f(d)),children:[e.jsxs(ne,{p:20,pb:"6rem",children:[e.jsx(P,{required:!0,label:"Nama",...l.getInputProps("nama")}),e.jsx(P,{required:!0,label:"Jumlah Penerimaan",type:"number",...l.getInputProps("jumlahPenerimaan")}),e.jsxs(q,{children:[e.jsx(q.Col,{md:6,children:e.jsx(K,{withAsterisk:!0,"aria-required":"true",label:"Waktu Pendaftaran Dibuka",dropdownType:"modal",...l.getInputProps("waktuDibuka"),clearable:!0})}),e.jsx(q.Col,{md:6,children:e.jsx(K,{required:!0,label:"Waktu Pendaftaran Ditutup",dropdownType:"modal",...l.getInputProps("waktuDitutup"),clearable:!0})})]}),e.jsx(_e,{required:!0,label:"Nama Bank",defaultValue:"CIMB",...l.getInputProps("namaBank"),data:["CIMB","BCA","BRI","BNI","MANDIRI"]}),e.jsx(P,{required:!0,label:"Nomor Rekening",type:"number",...l.getInputProps("nomorRekening")}),e.jsx(P,{required:!0,label:"Nama Pemilik Rekening",...l.getInputProps("namaPemilikRekening")}),e.jsx(je,{required:!0,thousandSeparator:".",decimalSeparator:",",prefix:"Rp. ",customInput:P,placeholder:"Rp. 0",label:"Biaya Pendaftaran",description:"Input Nominal",...l.getInputProps("biayaPendaftaran"),withAsterisk:!0}),e.jsx(P,{label:"Kode Gelombang",required:!0,...l.getInputProps("kodeGelombang")})]}),e.jsxs(I,{position:"right",sx:d=>({position:"absolute",bottom:0,right:0,left:0,padding:"1rem 4rem",backgroundColor:d.colorScheme==="dark"?"black":"whitesmoke",zIndex:1}),children:[e.jsx(w,{variant:"outline",onClick:()=>s(),children:"Batal"}),e.jsx(w,{type:"submit",loading:g,children:b})]})]})})},Me=()=>{var J,$;const t=ge(),{idJalurPendaftaran:s}=De(),o=we(),[m,{open:b,close:g}]=z(!1),[l,{open:f,close:d}]=z(!1),[_,{open:c,close:h}]=z(!1),u=re({initialValues:{id:null,nama:"",jumlahPenerimaan:"",waktuDibuka:null,waktuDitutup:null,namaBank:"",nomorRekening:"",namaPemilikRekening:"",biayaPendaftaran:null,kodeGelombang:""},transformValues:n=>({...n,biayaPendaftaran:+n.biayaPendaftaran.substring(4).replace(/\./g,""),waktuDibuka:n.waktuDibuka.toISOString(),waktuDitutup:n.waktuDitutup.toISOString()}),validate:{waktuDibuka:n=>n===null?"Tolong masukkan waktu dibuka":null,waktuDitutup:n=>n===null?"Tolong masukkan waktu ditutup":null}}),{data:p,isLoading:R,refetch:v}=oe({queryKey:["get_gelombang_by_id_jalur"],queryFn:()=>Be(s)});console.log({idJalurPendaftaran:s,gelombang:p});const V=A({mutationFn:Ue}),M=A({mutationFn:ve}),N=A({mutationFn:Ge});function Q(n){V.mutate(n,{onSuccess:i=>{console.log("SUCCESS : ",i),v(),g(),u.reset(),k.success("Data berhasil ditambahkan")},onError:i=>{k.error("Data gagal ditambahkan"),console.log("FAILED : ",i)}})}function X(n){M.mutate(n,{onSuccess:i=>{console.log("SUCCESS : ",i),d(),v(),u.reset(),k.success("Data berhasil diubah")},onError:i=>{console.log("FAILED : ",i),k.error("Data gagal diubah")}})}function a(n){N.mutate(n,{onSuccess:i=>{console.log("SUCCESS : ",i),h(),v(),k.success("Data berhasil dihapus")},onError:i=>{k.error("Data gagal dihapus"),console.log("FAILED : ",i)}})}function r(n){const{biayaPendaftaran:i,jumlahPenerimaan:U,nama:C,namaBank:G,namaPemilikRekening:F,nomorRekening:y,waktuDibuka:T,waktuDitutup:L,kodeGelombang:O}=n;Q({idJalur:+s,payloadCreate:{bank_account:y,bank_name:G,bank_user:F,end_date:L,index:1,max_quota:+U,name:C,price:i,start_date:T,batchCode:O}})}function x(n){const{id:i,biayaPendaftaran:U,jumlahPenerimaan:C,nama:G,namaBank:F,namaPemilikRekening:y,nomorRekening:T,waktuDibuka:L,waktuDitutup:O,kodeGelombang:Y}=n;X({id:+i,bank_account:T,bank_name:F,bank_user:y,end_date:O,index:1,max_quota:+C,name:G,price:U,start_date:L,batchCode:Y})}function D(n){a({id:n})}function B({propss:n,data:i}){return e.jsxs(Se,{children:[e.jsx(W.Control,{...n,className:"font-bold"}),e.jsxs("div",{style:{paddingInline:"16px",display:"flex",gap:"8px"},children:[e.jsx(ee,{variant:"filled",color:"brand-smp",size:40,radius:100,onClick:()=>{const{bank_account:U,bank_name:C,bank_user:G,end_date:F,max_quota:y,name:T,price:L,start_date:O,id:Y,batchCode:me}=i,pe=new Date(O),he=new Date(F);u.setValues({id:Y,biayaPendaftaran:"Rp. "+L,jumlahPenerimaan:y+"",kodeGelombang:me,nama:T,namaBank:C,namaPemilikRekening:G,nomorRekening:U,waktuDibuka:pe,waktuDitutup:he}),f()},children:e.jsx(Te,{size:20})}),e.jsx(ee,{variant:"filled",color:"brand-smp",size:40,radius:100,onClick:()=>{c(),u.setValues({id:i.id})},children:e.jsx(Ie,{size:20})})]})]})}const E=e.jsx(e.Fragment,{children:p!=null&&p.data&&((J=p==null?void 0:p.data)==null?void 0:J.length)<1?"":e.jsx(W,{multiple:!0,variant:"separated",chevronPosition:"left",mt:30,children:($=p==null?void 0:p.data)==null?void 0:$.sort((n,i)=>n.id-i.id).map(n=>{const i=n!=null&&n.start_date?new Date(n.start_date):null,U=i?i.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",C=n!=null&&n.end_date?new Date(n.end_date):null,G=C?C.toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}).replace(".",":").split(" pukul"):"Invalid Date",y=new Date>=i&&i<=C;return e.jsxs(W.Item,{value:n.id.toString(),sx:{boxShadow:"0 4px 10px -6px black",padding:"0 0.5rem",border:"0.0625rem solid #dee2e6",backgroundColor:`${t?o.colors.dark[9]:"white"}`,"&[data-active]":{backgroundColor:t?o.colors.dark[8]:"white",border:"0.0625rem solid #dee2e6"}},children:[e.jsx(B,{propss:{id:n.id.toString(),children:e.jsxs(e.Fragment,{children:[e.jsx(j,{fw:600,size:26,children:n.name}),e.jsxs(I,{mt:5,children:[e.jsx(ae,{variant:"light",size:30,radius:"50%",children:e.jsx(ye,{size:15})}),e.jsxs(j,{size:16,children:[" ",n.countStudent," Pendaftar"]})]})]})},data:n}),e.jsx(W.Panel,{sx:{borderTop:`1px solid ${t?"gray":"#d9d9d9"}`},children:e.jsxs(ne,{p:"1rem",children:[e.jsxs(Z,{withBorder:!0,p:"1rem",sx:T=>({backgroundColor:T.colorScheme==="dark"?T.colors.dark[9]:T.colors["brand-smp"][0],display:"flex",justifyContent:"space-between",alignItems:"center"}),children:[e.jsxs(I,{children:[e.jsx(ae,{radius:"100%",size:50,mx:"sm",children:e.jsx(Pe,{size:30})}),e.jsxs(le,{children:[e.jsx(j,{size:16,weight:"bolder",children:"Pendaftaran Gelombang"}),e.jsxs(j,{children:[U," â€“ ",G]})]})]}),e.jsx(ce,{variant:"light",color:`${y?"green":"red"}`,size:"lg",children:y?"Dibuka":"Ditutup"})]}),e.jsx(Ae,{idGelombang:n.id})]})})]},n.id)})})});return e.jsxs(fe,{title:"Gelombang",children:[e.jsxs(Z,{withBorder:!0,shadow:"sm",radius:"4rem",px:"2.5rem",bg:t?o.colors.dark[8]:"white",sx:{display:"flex",justifyContent:"space-between",padding:"1rem 2rem"},children:[e.jsx(j,{weight:"bold",size:"xl",children:"Daftar Gelombang"}),e.jsx(w,{onClick:()=>b(),children:"Tambah"})]}),R?e.jsx(Ce,{height:80}):E,e.jsx(ie,{title:"Tambah Gelombang PPDB",opened:m,close:g,formMantine:u,action:{actionFn:r,label:"Tambah"},loading:V.status==="pending"}),e.jsx(ie,{title:"Ubah Gelombang PPDB",opened:l,formMantine:u,action:{actionFn:x,label:"Ubah"},close:()=>{d(),u.reset()},loading:M.status==="pending"}),e.jsxs(de,{centered:!0,closeOnEscape:!1,closeOnClickOutside:!1,withCloseButton:!1,opened:_,onClose:()=>{h(),u.reset()},children:[e.jsx(ue,{order:3,children:"Hapus Gelombang"}),e.jsxs(j,{mt:20,children:["Anda yakin ingin menghapus gelombang ",u.values.nama,"?"]}),e.jsxs(I,{mt:20,position:"right",children:[e.jsx(w,{disabled:N.status==="pending",variant:"outline",onClick:()=>{h(),u.reset()},children:"Batal"}),e.jsx(w,{variant:"danger",onClick:()=>D(u.values.id),loading:N.status==="pending",children:"Hapus"})]})]})]})};export{Me as default};
